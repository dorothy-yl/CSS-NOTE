# 常见网络协议和默认端口号

## 一、传输层协议

### TCP (Transmission Control Protocol) - 传输控制协议
- **特点**：面向连接、可靠传输、有序传输、流量控制、拥塞控制
- **应用场景**：需要可靠传输的场景，如网页浏览、文件传输、邮件发送

### UDP (User Datagram Protocol) - 用户数据报协议
- **特点**：无连接、不可靠传输、传输速度快、开销小
- **应用场景**：实时性要求高的场景，如视频直播、在线游戏、DNS查询

## 二、应用层协议及默认端口

### Web相关协议

#### HTTP (HyperText Transfer Protocol) - 超文本传输协议
- **端口号**：80
- **作用**：用于Web浏览器和服务器之间传输超文本数据
- **特点**：无状态协议、基于请求-响应模型、明文传输

#### HTTPS (HTTP Secure) - 安全超文本传输协议
- **端口号**：443
- **作用**：HTTP的安全版本，通过SSL/TLS加密传输
- **特点**：数据加密、身份认证、数据完整性保护

#### WebSocket
- **端口号**：80 (ws://) 或 443 (wss://)
- **作用**：实现浏览器与服务器的全双工通信
- **特点**：持久连接、双向通信、低延迟

### 文件传输协议

#### FTP (File Transfer Protocol) - 文件传输协议
- **端口号**：21 (控制连接)、20 (数据连接)
- **作用**：在网络上进行文件传输
- **特点**：支持断点续传、目录操作、明文传输

#### SFTP (SSH File Transfer Protocol) - SSH文件传输协议
- **端口号**：22 (使用SSH端口)
- **作用**：基于SSH的安全文件传输
- **特点**：加密传输、身份认证、数据完整性

#### FTPS (FTP over SSL/TLS)
- **端口号**：990 (隐式加密) 或 21 (显式加密)
- **作用**：FTP的安全版本
- **特点**：支持SSL/TLS加密

### 邮件协议

#### SMTP (Simple Mail Transfer Protocol) - 简单邮件传输协议
- **端口号**：25 (标准)、587 (提交)、465 (加密)
- **作用**：发送邮件
- **特点**：推送协议、文本协议

#### POP3 (Post Office Protocol 3) - 邮局协议第3版
- **端口号**：110 (标准)、995 (加密)
- **作用**：接收邮件
- **特点**：下载邮件到本地、删除服务器副本

#### IMAP (Internet Message Access Protocol) - 互联网消息访问协议
- **端口号**：143 (标准)、993 (加密)
- **作用**：接收和管理邮件
- **特点**：邮件保存在服务器、支持多设备同步、支持文件夹管理

### 远程连接协议

#### SSH (Secure Shell) - 安全外壳协议
- **端口号**：22
- **作用**：远程登录和命令执行
- **特点**：加密传输、身份认证、端口转发

#### Telnet - 远程登录协议
- **端口号**：23
- **作用**：远程登录（不安全，已不推荐）
- **特点**：明文传输、简单易用

#### RDP (Remote Desktop Protocol) - 远程桌面协议
- **端口号**：3389
- **作用**：Windows远程桌面连接
- **特点**：图形界面、支持音视频传输

### 域名解析

#### DNS (Domain Name System) - 域名系统
- **端口号**：53 (UDP/TCP)
- **作用**：域名与IP地址转换
- **特点**：分布式系统、缓存机制、递归查询

### 数据库协议

#### MySQL
- **端口号**：3306
- **作用**：MySQL数据库连接

#### PostgreSQL
- **端口号**：5432
- **作用**：PostgreSQL数据库连接

#### MongoDB
- **端口号**：27017
- **作用**：MongoDB数据库连接

#### Redis
- **端口号**：6379
- **作用**：Redis缓存数据库连接

#### Oracle
- **端口号**：1521
- **作用**：Oracle数据库连接

#### SQL Server
- **端口号**：1433
- **作用**：Microsoft SQL Server连接

### 其他常见协议

#### DHCP (Dynamic Host Configuration Protocol) - 动态主机配置协议
- **端口号**：67 (服务器)、68 (客户端)
- **作用**：自动分配IP地址
- **特点**：简化网络配置、支持IP地址租期

#### SNMP (Simple Network Management Protocol) - 简单网络管理协议
- **端口号**：161 (代理)、162 (管理站)
- **作用**：网络设备管理和监控
- **特点**：轮询机制、陷阱通知

#### NTP (Network Time Protocol) - 网络时间协议
- **端口号**：123
- **作用**：时间同步
- **特点**：分层结构、高精度

#### LDAP (Lightweight Directory Access Protocol) - 轻量级目录访问协议
- **端口号**：389 (标准)、636 (加密)
- **作用**：访问和维护分布式目录信息
- **特点**：树形结构、支持认证

## 三、面试必背要点

### 1. TCP vs UDP 对比
```
TCP：
- 面向连接（三次握手建立连接）
- 可靠传输（确认机制、重传机制）
- 有序传输（序列号）
- 流量控制（滑动窗口）
- 拥塞控制（慢开始、拥塞避免、快重传、快恢复）
- 应用：HTTP/HTTPS、FTP、SMTP、SSH

UDP：
- 无连接
- 不可靠传输
- 无序传输
- 传输速度快
- 头部开销小（8字节 vs TCP的20字节）
- 应用：DNS、DHCP、视频流、在线游戏
```

### 2. HTTP vs HTTPS
```
HTTP：
- 端口80
- 明文传输
- 无身份认证
- 无数据完整性验证

HTTPS：
- 端口443
- SSL/TLS加密
- 数字证书认证
- 防止中间人攻击
- SEO权重更高
```

### 3. 常见端口号速记口诀
```
Web服务：
- HTTP走80，HTTPS走443
- FTP控制21，数据传20

邮件服务：
- SMTP发邮件25/587/465
- POP3收邮件110/995
- IMAP管邮件143/993

远程连接：
- SSH安全连22
- Telnet不安全23
- Windows远程3389

数据库：
- MySQL是3306
- PostgreSQL是5432
- MongoDB是27017
- Redis是6379
- Oracle是1521
- SQL Server是1433

其他：
- DNS解析找53
- DHCP分配67/68
```

### 4. 三次握手和四次挥手端口使用
```
三次握手：
1. 客户端随机端口 → 服务器固定端口 (SYN)
2. 服务器固定端口 → 客户端随机端口 (SYN+ACK)
3. 客户端随机端口 → 服务器固定端口 (ACK)

四次挥手：
使用已建立连接的相同端口对
```

### 5. 端口号范围
```
- 0-1023：知名端口（Well-Known Ports），需要root权限
- 1024-49151：注册端口（Registered Ports）
- 49152-65535：动态端口（Dynamic Ports），客户端临时端口
```

### 6. 安全相关
```
加密版本对应关系：
- HTTP (80) → HTTPS (443)
- FTP (21) → SFTP (22) / FTPS (990)
- Telnet (23) → SSH (22)
- POP3 (110) → POP3S (995)
- IMAP (143) → IMAPS (993)
- SMTP (25) → SMTPS (465/587)
- LDAP (389) → LDAPS (636)
```

### 7. 面试高频考点
```
1. TCP和UDP的区别及应用场景
2. HTTP和HTTPS的区别
3. 常见协议的默认端口号
4. 为什么需要三次握手，两次行不行？
5. 为什么需要四次挥手？
6. TIME_WAIT状态的作用
7. HTTP状态码分类
8. DNS解析过程
9. HTTPS的工作原理
10. WebSocket与HTTP的区别
```

## 四、实战应用题

### 题目1：如何查看本机开放的端口？
```bash
# Windows
netstat -an

# Linux/Mac
netstat -tuln
lsof -i -P -n
ss -tuln
```

### 题目2：如何测试远程端口是否开放？
```bash
# telnet
telnet hostname port

# nc (netcat)
nc -zv hostname port

# nmap
nmap -p port hostname
```

### 题目3：防火墙配置示例
```bash
# iptables (Linux)
# 开放80端口
iptables -A INPUT -p tcp --dport 80 -j ACCEPT

# firewalld (CentOS 7+)
firewall-cmd --permanent --add-port=80/tcp
firewall-cmd --reload

# ufw (Ubuntu)
ufw allow 80/tcp
```

### 题目4：常见端口安全建议
```
1. 修改默认端口（如SSH从22改为其他）
2. 限制端口访问IP范围
3. 使用防火墙规则
4. 定期端口扫描审计
5. 关闭不必要的服务和端口
6. 使用加密协议版本
```

## 五、记忆技巧

### 端口号记忆规律
1. **成对记忆**：
   - HTTP/HTTPS = 80/443
   - POP3/POP3S = 110/995
   - IMAP/IMAPS = 143/993

2. **分类记忆**：
   - Web类：80、443、8080、8443
   - 邮件类：25、110、143、587、993、995
   - 数据库类：3306、5432、6379、27017

3. **特殊数字**：
   - SSH = 22 (双2)
   - DNS = 53 (五三)
   - DHCP = 67/68 (连续)
   - MySQL = 3306 (33零6)

### 速记表格

| 分类 | 协议 | 端口 | 记忆方法 |
|------|------|------|----------|
| Web | HTTP | 80 | 八十大关 |
| Web | HTTPS | 443 | 四四三，死死守 |
| 远程 | SSH | 22 | 双二安全 |
| 邮件 | SMTP | 25 | 二五发送 |
| 域名 | DNS | 53 | 五三解析 |
| 数据库 | MySQL | 3306 | 三三零六 |
| 数据库 | Redis | 6379 | 六三七九 |
| 远程 | RDP | 3389 | 三三八九，Windows就用 |