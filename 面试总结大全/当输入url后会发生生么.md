# 当输入URL后会发生什么？

## 1. URL补全和纠错
- **URL补全**：根据历史记录自动补全，添加协议，格式校验和编码
- **缓存检查**：检查浏览器缓存，有效则直接使用，过期则发送条件请求

## 2. DNS解析
**解析顺序**：浏览器缓存 → 系统缓存 → hosts文件 → 路由器缓存 → ISP DNS → 递归查询（根DNS → 顶级域DNS → 权威DNS）

## 3. 建立连接
**TCP三次握手**：客户端SYN → 服务器SYN+ACK → 客户端ACK

**HTTPS额外步骤**：TLS握手（ClientHello → ServerHello+证书 → 证书验证 → 密钥交换 → 加密通信）

## 4. 发送HTTP请求
**核心请求头**：Host（域名）、User-Agent（浏览器标识）、Accept（内容类型）、Connection（连接管理）、Cookie（会话）

## 5. 服务器响应
**处理流程**：接收请求 → 路由解析 → 权限验证 → 业务处理（静态/动态/数据库） → 构建响应

**常见状态码**：200（成功）、301/302（重定向）、304（缓存）、404（未找到）、500（服务器错误）

## 6. 浏览器渲染
**渲染流程**：HTML解析构建DOM → CSS解析构建CSSOM → JS执行 → 构建渲染树 → 布局计算 → 绘制 → 合成

**关键点**：
- CSS不阻塞DOM构建但阻塞渲染
- 同步JS阻塞HTML解析
- 使用async/defer优化JS加载

## 7. 连接关闭
**TCP四次挥手**：客户端FIN → 服务器ACK → 服务器FIN → 客户端ACK