# åˆçº§å‰ç«¯ä¸‰å¤©å¤ä¹ è®¡åˆ’ - ç¬¬äºŒå¤©ï¼ˆå®Œæ•´ç‰ˆï¼‰

> å­¦ä¹ è¯´æ˜ï¼šæœ¬æ–‡æ¡£æ•´åˆäº†CSSå¸ƒå±€ã€Vueè¿›é˜¶ã€JavaScriptæ ¸å¿ƒå’Œäº‹ä»¶æœºåˆ¶çš„å®Œæ•´è¯¦ç»†å†…å®¹ï¼ŒåŒ…å«æ‰€æœ‰ä»£ç ç¤ºä¾‹ã€è¡¨æ ¼ã€è®°å¿†å£è¯€ã€‚é€‚åˆåˆçº§å‰ç«¯å·¥ç¨‹å¸ˆç³»ç»Ÿå¤ä¹ ã€‚

## ğŸ“š ä»Šæ—¥å­¦ä¹ å†…å®¹

- **ç¬¬ä¸€éƒ¨åˆ†**ï¼šCSSå¸ƒå±€ï¼ˆdisplayå±æ€§ã€å…ƒç´ éšè—æ–¹æ³•ï¼‰
- **ç¬¬äºŒéƒ¨åˆ†**ï¼šVueè¿›é˜¶ï¼ˆç»„ä»¶é€šä¿¡ã€ç”Ÿå‘½å‘¨æœŸï¼‰
- **ç¬¬ä¸‰éƒ¨åˆ†**ï¼šJavaScriptè¿›é˜¶ï¼ˆthisæŒ‡å‘ã€ä½œç”¨åŸŸä¸é—­åŒ…ï¼‰
- **ç¬¬å››éƒ¨åˆ†**ï¼šäº‹ä»¶æœºåˆ¶è¿›é˜¶ï¼ˆaddEventListenerè¯¦è§£ã€é˜²æŠ–èŠ‚æµï¼‰

---

# ç¬¬ä¸€éƒ¨åˆ†ï¼šCSSå¸ƒå±€ï¼ˆå®Œæ•´è¯¦ç»†ï¼‰

## ä¸€ã€displayå±æ€§

### ä¸‰å¤§æ ¸å¿ƒå€¼å®Œæ•´å¯¹æ¯”

**é‡è¦æ€§ï¼šâ­â­â­â­â­ é«˜é¢‘å¿…è€ƒ**

| å±æ€§å€¼ | inlineï¼ˆå†…è”ï¼‰ | blockï¼ˆå—çº§ï¼‰ | inline-blockï¼ˆå†…è”å—ï¼‰ |
|--------|----------------|---------------|----------------------|
| **ç‹¬å ä¸€è¡Œ** | âŒ ä¸ç‹¬å  | âœ… ç‹¬å  | âŒ ä¸ç‹¬å  |
| **width/height** | âŒ ä¸èƒ½è®¾ç½® | âœ… å¯ä»¥è®¾ç½® | âœ… å¯ä»¥è®¾ç½® |
| **margin/padding** | åªæœ‰æ°´å¹³æ–¹å‘ | æ‰€æœ‰æ–¹å‘ | æ‰€æœ‰æ–¹å‘ |
| **é»˜è®¤å®½åº¦** | ç”±å†…å®¹å†³å®š | çˆ¶å®¹å™¨100% | ç”±å†…å®¹å†³å®š |
| **å¸¸è§å…ƒç´ ** | spanã€aã€em | divã€pã€h1-h6 | imgã€inputã€button |

### 1) inlineï¼ˆå†…è”å…ƒç´ ï¼‰

**ç‰¹ç‚¹ï¼š**
- å…ƒç´ åœ¨ä¸€è¡Œå†…æ˜¾ç¤ºï¼Œä¸ä¼šæ¢è¡Œ
- ä¸èƒ½è®¾ç½®widthå’Œheight
- åªèƒ½è®¾ç½®æ°´å¹³æ–¹å‘çš„marginå’Œpadding
- å†…å®¹å†³å®šå…ƒç´ å¤§å°

**ä»£ç ç¤ºä¾‹ï¼š**
```css
span {
  display: inline;
  width: 100px;    /* âŒ æ— æ•ˆ */
  height: 50px;    /* âŒ æ— æ•ˆ */
  margin-top: 10px; /* âŒ æ— æ•ˆ */
  margin-left: 10px; /* âœ… æœ‰æ•ˆ */
  padding-top: 10px; /* âŒ æ— æ•ˆï¼ˆä¸å½±å“å¸ƒå±€ï¼‰ */
  padding-left: 10px; /* âœ… æœ‰æ•ˆ */
}
```

**å¸¸è§åº”ç”¨ï¼š**
```html
<!-- æ–‡æœ¬ä¸­çš„é“¾æ¥ã€å¼ºè°ƒæ–‡æœ¬ -->
<p>è¿™æ˜¯ä¸€æ®µæ–‡å­—ï¼ŒåŒ…å«<a href="#">é“¾æ¥</a>å’Œ<em>å¼ºè°ƒå†…å®¹</em></p>
```

### 2) blockï¼ˆå—çº§å…ƒç´ ï¼‰

**ç‰¹ç‚¹ï¼š**
- ç‹¬å ä¸€è¡Œï¼Œä¼šæ¢è¡Œ
- å¯ä»¥è®¾ç½®widthå’Œheight
- å¯ä»¥è®¾ç½®æ‰€æœ‰æ–¹å‘çš„marginå’Œpadding
- é»˜è®¤å®½åº¦æ˜¯çˆ¶å®¹å™¨çš„100%

**ä»£ç ç¤ºä¾‹ï¼š**
```css
div {
  display: block;
  width: 200px;     /* âœ… æœ‰æ•ˆ */
  height: 100px;    /* âœ… æœ‰æ•ˆ */
  margin: 20px;     /* âœ… æ‰€æœ‰æ–¹å‘éƒ½æœ‰æ•ˆ */
  padding: 10px;    /* âœ… æ‰€æœ‰æ–¹å‘éƒ½æœ‰æ•ˆ */
}
```

**å¸¸è§åº”ç”¨ï¼š**
```html
<!-- é¡µé¢å¸ƒå±€çš„ä¸»è¦å®¹å™¨ -->
<div class="container">
  <h1>æ ‡é¢˜</h1>
  <p>æ®µè½å†…å®¹</p>
</div>
```

### 3) inline-blockï¼ˆå†…è”å—çº§å…ƒç´ ï¼‰â­â­â­â­â­

**ç‰¹ç‚¹ï¼š**
- ç»“åˆäº†inlineå’Œblockçš„ç‰¹æ€§
- åƒinlineä¸€æ ·åœ¨ä¸€è¡Œå†…æ˜¾ç¤ºï¼Œä¸ä¼šæ¢è¡Œ
- åƒblockä¸€æ ·å¯ä»¥è®¾ç½®widthã€heightã€marginã€padding
- å¸¸ç”¨äºå¯¼èˆªèœå•ã€æŒ‰é’®ç»„ã€å›¾ç‰‡åˆ—è¡¨ç­‰

**ä»£ç ç¤ºä¾‹ï¼š**
```css
span {
  display: inline-block;
  width: 120px;     /* âœ… æœ‰æ•ˆ */
  height: 40px;     /* âœ… æœ‰æ•ˆ */
  margin: 10px;     /* âœ… æ‰€æœ‰æ–¹å‘éƒ½æœ‰æ•ˆ */
  padding: 5px;     /* âœ… æ‰€æœ‰æ–¹å‘éƒ½æœ‰æ•ˆ */
  vertical-align: middle; /* å¯ä»¥è®¾ç½®å‚ç›´å¯¹é½ */
}
```

**å®é™…åº”ç”¨ç¤ºä¾‹ï¼š**
```html
<style>
  /* ç¤ºä¾‹1ï¼šå›ºå®šå®½åº¦çš„è¡¨å•æ ‡ç­¾ */
  .form-label {
    display: inline-block;
    width: 120px;
    text-align: right;
    margin-right: 10px;
  }

  /* ç¤ºä¾‹2ï¼šå¯¼èˆªèœå• */
  .nav-item {
    display: inline-block;
    padding: 10px 20px;
    margin: 0 5px;
    background: #f0f0f0;
  }

  /* ç¤ºä¾‹3ï¼šæŒ‰é’®ç»„ */
  .btn {
    display: inline-block;
    width: 100px;
    height: 40px;
    line-height: 40px;
    text-align: center;
    background: #007bff;
    color: white;
  }
</style>

<!-- è¡¨å•å¸ƒå±€ -->
<div class="form-item">
  <span class="form-label">ç”¨æˆ·å:</span>
  <input type="text">
</div>
<div class="form-item">
  <span class="form-label">ä¸Šæ¬¡ç™»å½•æ—¶é—´:</span>
  <span>2022-7-11</span>
</div>

<!-- å¯¼èˆªèœå• -->
<nav>
  <a class="nav-item" href="#">é¦–é¡µ</a>
  <a class="nav-item" href="#">äº§å“</a>
  <a class="nav-item" href="#">å…³äº</a>
</nav>

<!-- æŒ‰é’®ç»„ -->
<div>
  <span class="btn">ç¡®å®š</span>
  <span class="btn">å–æ¶ˆ</span>
</div>
```

### å…¶ä»–displayå€¼

```css
/* ä¸æ˜¾ç¤ºï¼Œä¸å ç©ºé—´ */
.hide {
  display: none;
}

/* å¼¹æ€§å¸ƒå±€ */
.flex-container {
  display: flex;
}

/* ç½‘æ ¼å¸ƒå±€ */
.grid-container {
  display: grid;
}

/* è¡¨æ ¼å¸ƒå±€ */
.table {
  display: table;
}

/* è¡¨æ ¼è¡Œ */
.table-row {
  display: table-row;
}

/* è¡¨æ ¼å•å…ƒæ ¼ */
.table-cell {
  display: table-cell;
}
```

### è®°å¿†å£è¯€

```
inlineè¡Œå†…ä¸æ¢è¡Œã€å®½é«˜è®¾ç½®éƒ½æ— æ•ˆ
blockå—çº§ç‹¬å è¡Œã€å®½é«˜è¾¹è·å…¨èƒ½è®¾
inline-blockæœ€çµæ´»ã€è¡Œå†…æ˜¾ç¤ºå¯è®¾å®½é«˜
```

---

## äºŒã€å…ƒç´ éšè—æ–¹æ³•

### ä¹ç§éšè—æ–¹æ³•å®Œæ•´å¯¹æ¯”

**é‡è¦æ€§ï¼šâ­â­â­â­ é«˜é¢‘è€ƒç‚¹**

| æ–¹æ³• | æ˜¯å¦å æ®ç©ºé—´ | æ˜¯å¦å¯äº¤äº’ | æ˜¯å¦å½±å“å­å…ƒç´  | æ€§èƒ½å½±å“ | åº”ç”¨åœºæ™¯ |
|------|-------------|-----------|---------------|----------|----------|
| **display: none** | âŒ ä¸å æ® | âŒ ä¸å¯äº¤äº’ | âœ… å½±å“ | é‡æ’+é‡ç»˜ | å®Œå…¨éšè— |
| **visibility: hidden** | âœ… å æ® | âŒ ä¸å¯äº¤äº’ | âœ… å½±å“ | ä»…é‡ç»˜ | ä¿ç•™å¸ƒå±€ç©ºé—´ |
| **opacity: 0** | âœ… å æ® | âœ… å¯äº¤äº’ | âœ… å½±å“ | å¯èƒ½è§¦å‘åˆæˆ | é€æ˜åŠ¨ç”» |
| **position + left: -9999px** | âŒ ä¸å æ® | âŒ ä¸å¯äº¤äº’ | âœ… å½±å“ | é‡æ’+é‡ç»˜ | ç§»å‡ºè§†å£ |
| **clip-path: polygon(0 0)** | âœ… å æ® | âŒ ä¸å¯äº¤äº’ | âœ… å½±å“ | å¯èƒ½è§¦å‘åˆæˆ | è£å‰ªéšè— |
| **transform: scale(0)** | âœ… å æ® | âŒ ä¸å¯äº¤äº’ | âœ… å½±å“ | å¯èƒ½è§¦å‘åˆæˆ | ç¼©æ”¾åŠ¨ç”» |
| **height: 0 + overflow: hidden** | âŒ ä¸å æ® | âŒ ä¸å¯äº¤äº’ | âœ… å½±å“ | é‡æ’+é‡ç»˜ | æŠ˜å åŠ¨ç”» |
| **z-index: -1** | âœ… å æ® | âŒ ä¸å¯äº¤äº’ | âŒ ä¸å½±å“ | ä»…é‡ç»˜ | å±‚çº§éšè— |
| **filter: blur(0)** | âœ… å æ® | âœ… å¯äº¤äº’ | âœ… å½±å“ | å¯èƒ½è§¦å‘åˆæˆ | æ¨¡ç³Šæ•ˆæœ |

### 1) display: noneï¼ˆæœ€å¸¸ç”¨ï¼‰â­â­â­â­â­

**è¯´æ˜ï¼š**
- å…ƒç´ å®Œå…¨æ¶ˆå¤±ï¼Œä¸å æ®ç©ºé—´
- ä¸å¯äº¤äº’ï¼ˆæ— æ³•ç‚¹å‡»ï¼‰
- è§¦å‘é‡æ’ï¼ˆreflowï¼‰å’Œé‡ç»˜ï¼ˆrepaintï¼‰
- å­å…ƒç´ ä¹Ÿä¼šè¢«éšè—ï¼Œä¸”æ— æ³•é€šè¿‡è®¾ç½®displayæ¥æ˜¾ç¤º

**ä»£ç ç¤ºä¾‹ï¼š**
```css
.hide {
  display: none;  /* å…ƒç´ å®Œå…¨æ¶ˆå¤±ï¼Œä¸å ç©ºé—´ */
}
```

**JavaScriptæ§åˆ¶ï¼š**
```javascript
// éšè—å…ƒç´ 
element.style.display = 'none';

// æ˜¾ç¤ºå…ƒç´ 
element.style.display = 'block'; // æˆ– 'inline'ã€'inline-block'
```

**åº”ç”¨åœºæ™¯ï¼š**
```html
<!-- æ¨¡æ€æ¡†çš„æ˜¾ç¤ºéšè— -->
<div class="modal" style="display: none;">
  <div class="modal-content">
    <p>æ¨¡æ€æ¡†å†…å®¹</p>
  </div>
</div>

<script>
// æ˜¾ç¤ºæ¨¡æ€æ¡†
document.querySelector('.modal').style.display = 'block';

// éšè—æ¨¡æ€æ¡†
document.querySelector('.modal').style.display = 'none';
</script>
```

### 2) visibility: hidden

**è¯´æ˜ï¼š**
- å…ƒç´ ä¸å¯è§ï¼Œä½†å æ®ç©ºé—´ä½ç½®
- ä¸å¯äº¤äº’ï¼ˆæ— æ³•ç‚¹å‡»ï¼‰
- åªè§¦å‘é‡ç»˜ï¼ˆrepaintï¼‰ï¼Œä¸è§¦å‘é‡æ’
- å­å…ƒç´ å¯ä»¥é€šè¿‡è®¾ç½®visibility: visibleæ¥æ˜¾ç¤º

**ä»£ç ç¤ºä¾‹ï¼š**
```css
.hide {
  visibility: hidden;  /* å…ƒç´ ä¸å¯è§ï¼Œä½†å æ®ç©ºé—´ */
}

/* å­å…ƒç´ å¯ä»¥æ˜¾ç¤º */
.hide .child {
  visibility: visible;
}
```

**JavaScriptæ§åˆ¶ï¼š**
```javascript
// éšè—å…ƒç´ 
element.style.visibility = 'hidden';

// æ˜¾ç¤ºå…ƒç´ 
element.style.visibility = 'visible';
```

**åº”ç”¨åœºæ™¯ï¼š**
```html
<!-- ä¿ç•™å¸ƒå±€ç©ºé—´çš„éšè— -->
<style>
  .placeholder {
    visibility: hidden;
  }
</style>

<div class="container">
  <div class="item">å¯è§é¡¹1</div>
  <div class="item placeholder">å ä½é¡¹</div>
  <div class="item">å¯è§é¡¹2</div>
</div>
```

### 3) opacity: 0

**è¯´æ˜ï¼š**
- å…ƒç´ å®Œå…¨é€æ˜ï¼Œä½†å æ®ç©ºé—´
- âš ï¸ ä»å¯äº¤äº’ï¼ˆå¯ä»¥ç‚¹å‡»ã€å¯ä»¥è§¦å‘äº‹ä»¶ï¼‰
- é€‚åˆåšæ¸å˜åŠ¨ç”»
- å¯èƒ½è§¦å‘GPUåˆæˆ

**ä»£ç ç¤ºä¾‹ï¼š**
```css
.hide {
  opacity: 0;  /* é€æ˜åº¦ä¸º0ï¼Œå…ƒç´ é€æ˜ä½†ä»å æ®ç©ºé—´ */
}

/* é…åˆtransitionåšæ¸å˜æ•ˆæœ */
.fade {
  opacity: 1;
  transition: opacity 0.3s;
}

.fade.hide {
  opacity: 0;
}
```

**JavaScriptæ§åˆ¶ï¼š**
```javascript
// éšè—å…ƒç´ ï¼ˆå¸¦åŠ¨ç”»ï¼‰
element.style.transition = 'opacity 0.3s';
element.style.opacity = '0';

// æ˜¾ç¤ºå…ƒç´ ï¼ˆå¸¦åŠ¨ç”»ï¼‰
element.style.opacity = '1';
```

**åº”ç”¨åœºæ™¯ï¼š**
```html
<!-- æ·¡å…¥æ·¡å‡ºåŠ¨ç”» -->
<style>
  .tooltip {
    opacity: 0;
    transition: opacity 0.3s;
    pointer-events: none; /* ç¦æ­¢äº¤äº’ */
  }

  .tooltip.show {
    opacity: 1;
    pointer-events: auto; /* æ¢å¤äº¤äº’ */
  }
</style>

<div class="tooltip">æç¤ºä¿¡æ¯</div>

<script>
// æ˜¾ç¤ºæç¤º
document.querySelector('.tooltip').classList.add('show');

// éšè—æç¤º
setTimeout(() => {
  document.querySelector('.tooltip').classList.remove('show');
}, 3000);
</script>
```

### 4) ç§»å‡ºè§†å£ï¼ˆposition + left: -9999pxï¼‰

**è¯´æ˜ï¼š**
- å°†å…ƒç´ ç§»åˆ°å±å¹•å¤–ï¼Œä¸å æ®åŸä½ç½®ç©ºé—´
- ä¸å¯äº¤äº’
- å¯¹SEOå‹å¥½ï¼ˆæœç´¢å¼•æ“ä»èƒ½è¯»å–å†…å®¹ï¼‰

**ä»£ç ç¤ºä¾‹ï¼š**
```css
.hide {
  position: absolute;
  left: -9999px;  /* ç§»åˆ°å±å¹•å¤– */
  top: -9999px;
}

/* æˆ–ä½¿ç”¨translate */
.hide-translate {
  transform: translateX(-9999px);
}
```

**åº”ç”¨åœºæ™¯ï¼š**
```html
<!-- å±å¹•é˜…è¯»å™¨å¯è®¿é—®çš„å†…å®¹ -->
<style>
  .sr-only {
    position: absolute;
    left: -10000px;
    width: 1px;
    height: 1px;
    overflow: hidden;
  }
</style>

<button>
  <span class="sr-only">å…³é—­å¯¹è¯æ¡†</span>
  <span aria-hidden="true">Ã—</span>
</button>
```

### 5) è£å‰ªè·¯å¾„ï¼ˆclip-pathï¼‰

**è¯´æ˜ï¼š**
- é€šè¿‡è£å‰ªè·¯å¾„éšè—å…ƒç´ 
- å æ®ç©ºé—´ï¼Œä¸å¯äº¤äº’
- å¯ä»¥å®ç°å„ç§å½¢çŠ¶çš„è£å‰ªæ•ˆæœ

**ä»£ç ç¤ºä¾‹ï¼š**
```css
.hide {
  clip-path: polygon(0 0, 0 0, 0 0, 0 0);  /* è£å‰ªä¸º0å¤§å° */
}

/* åœ†å½¢è£å‰ª */
.circle {
  clip-path: circle(50%);
}

/* ä¸‰è§’å½¢è£å‰ª */
.triangle {
  clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
}
```

**åº”ç”¨åœºæ™¯ï¼š**
```html
<!-- å›¾ç‰‡è£å‰ªæ•ˆæœ -->
<style>
  .img-circle {
    clip-path: circle(50%);
  }

  .img-hexagon {
    clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
  }
</style>

<img src="avatar.jpg" class="img-circle">
<img src="photo.jpg" class="img-hexagon">
```

### 6) ç¼©æ”¾ï¼ˆtransform: scale(0)ï¼‰

**è¯´æ˜ï¼š**
- å°†å…ƒç´ ç¼©æ”¾ä¸º0
- å æ®ç©ºé—´ï¼Œä¸å¯äº¤äº’
- é€‚åˆåšç¼©æ”¾åŠ¨ç”»

**ä»£ç ç¤ºä¾‹ï¼š**
```css
.hide {
  transform: scale(0);  /* ç¼©æ”¾ä¸º0 */
}

/* é…åˆtransitionåšåŠ¨ç”» */
.zoom {
  transform: scale(1);
  transition: transform 0.3s;
}

.zoom.hide {
  transform: scale(0);
}
```

**åº”ç”¨åœºæ™¯ï¼š**
```html
<!-- ç¼©æ”¾åŠ¨ç”» -->
<style>
  .modal {
    transform: scale(0);
    transition: transform 0.3s;
  }

  .modal.show {
    transform: scale(1);
  }
</style>

<div class="modal">
  <p>æ¨¡æ€æ¡†å†…å®¹</p>
</div>
```

### 7) é«˜åº¦æŠ˜å ï¼ˆheight: 0 + overflow: hiddenï¼‰

**è¯´æ˜ï¼š**
- å°†é«˜åº¦è®¾ä¸º0å¹¶éšè—æº¢å‡ºå†…å®¹
- ä¸å æ®ç©ºé—´ï¼Œä¸å¯äº¤äº’
- é€‚åˆåšæŠ˜å /å±•å¼€åŠ¨ç”»

**ä»£ç ç¤ºä¾‹ï¼š**
```css
.hide {
  height: 0;
  overflow: hidden;
}

/* é…åˆtransitionåšæŠ˜å åŠ¨ç”» */
.collapse {
  height: auto;
  transition: height 0.3s;
}

.collapse.hide {
  height: 0;
}
```

**åº”ç”¨åœºæ™¯ï¼š**
```html
<!-- æ‰‹é£ç´æ•ˆæœ -->
<style>
  .accordion-content {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s;
  }

  .accordion-content.show {
    max-height: 500px; /* è®¾ç½®ä¸€ä¸ªè¶³å¤Ÿå¤§çš„å€¼ */
  }
</style>

<div class="accordion">
  <div class="accordion-header" onclick="toggleAccordion()">
    ç‚¹å‡»å±•å¼€/æ”¶èµ·
  </div>
  <div class="accordion-content">
    <p>æŠ˜å çš„å†…å®¹</p>
  </div>
</div>

<script>
function toggleAccordion() {
  document.querySelector('.accordion-content').classList.toggle('show');
}
</script>
```

### 8) å±‚çº§éšè—ï¼ˆz-index: -1ï¼‰

**è¯´æ˜ï¼š**
- å°†å…ƒç´ æ”¾åˆ°å…¶ä»–å…ƒç´ åé¢
- å æ®ç©ºé—´ï¼Œä¸å¯äº¤äº’ï¼ˆè¢«å…¶ä»–å…ƒç´ é®æŒ¡ï¼‰
- ä¸å½±å“å­å…ƒç´ 

**ä»£ç ç¤ºä¾‹ï¼š**
```css
.hide {
  position: relative;
  z-index: -1;  /* æ”¾åˆ°åé¢ */
}
```

### 9) æ¨¡ç³Šï¼ˆfilter: blurï¼‰

**è¯´æ˜ï¼š**
- å°†å…ƒç´ æ¨¡ç³ŠåŒ–
- å æ®ç©ºé—´ï¼Œå¯äº¤äº’
- å¯ä»¥å®ç°æ¨¡ç³Šæ•ˆæœ

**ä»£ç ç¤ºä¾‹ï¼š**
```css
.blur {
  filter: blur(10px);
}
```

### è®°å¿†å£è¯€

```
displayä¸å ä½ã€visibilityå ä½ä¸å¯è§
opacityé€æ˜å¯ç‚¹å‡»ã€positionç§»å‡ºè§†å£å¤–
clip-pathè£å‰ªhideã€scaleç¼©æ”¾ä¸ºé›¶
heightæŠ˜å overflowã€z-indexå±‚çº§è—ã€filteræ¨¡ç³Šçœ‹ä¸æ¸…
```

**æ€§èƒ½å¯¹æ¯”å£è¯€ï¼š**
```
displayæœ€ä¼¤æ€§èƒ½ï¼ˆé‡æ’+é‡ç»˜ï¼‰
visibilityæ¬¡ä¹‹ä»…é‡ç»˜
opacityæ€§èƒ½æœ€å¥½ï¼ˆå¯èƒ½GPUåŠ é€Ÿï¼‰
transformæ€§èƒ½ä¹Ÿä¸é”™ï¼ˆå¯èƒ½GPUåŠ é€Ÿï¼‰
```

---

# ç¬¬äºŒéƒ¨åˆ†ï¼šVueè¿›é˜¶ï¼ˆå®Œæ•´è¯¦ç»†ï¼‰

## ä¸€ã€ç»„ä»¶é€šä¿¡

### 1. props + emitï¼ˆçˆ¶å­é€šä¿¡ï¼‰â­â­â­â­â­

**æ ¸å¿ƒå£è¯€ï¼šçˆ¶ä¼ å­propsã€å­ä¼ çˆ¶emit**

#### Vue3 å®Œæ•´ä»£ç ç¤ºä¾‹

**çˆ¶ç»„ä»¶ï¼ˆParent.vueï¼‰ï¼š**
```vue
<template>
  <div class="parent">
    <h2>çˆ¶ç»„ä»¶</h2>
    <p>çˆ¶ç»„ä»¶çš„æ•°æ®ï¼š{{ parentMessage }}</p>
    <p>ä»å­ç»„ä»¶æ¥æ”¶çš„æ•°æ®ï¼š{{ childData }}</p>

    <!-- é€šè¿‡propsä¼ é€’æ•°æ®ç»™å­ç»„ä»¶ -->
    <!-- é€šè¿‡@updateç›‘å¬å­ç»„ä»¶çš„äº‹ä»¶ -->
    <Child
      :message="parentMessage"
      :count="count"
      @update="handleUpdate"
      @increment="handleIncrement"
    />
  </div>
</template>

<script setup>
import { ref } from 'vue';
import Child from './Child.vue';

// çˆ¶ç»„ä»¶çš„æ•°æ®
const parentMessage = ref('è¿™æ˜¯æ¥è‡ªçˆ¶ç»„ä»¶çš„æ¶ˆæ¯');
const count = ref(0);
const childData = ref('');

// å¤„ç†å­ç»„ä»¶ä¼ æ¥çš„æ•°æ®
const handleUpdate = (data) => {
  console.log('æ”¶åˆ°å­ç»„ä»¶çš„æ•°æ®:', data);
  childData.value = data;
};

// å¤„ç†å­ç»„ä»¶çš„è®¡æ•°å¢åŠ 
const handleIncrement = (newCount) => {
  console.log('å­ç»„ä»¶è®¡æ•°å˜åŒ–:', newCount);
  count.value = newCount;
};
</script>
```

**å­ç»„ä»¶ï¼ˆChild.vueï¼‰ï¼š**
```vue
<template>
  <div class="child">
    <h3>å­ç»„ä»¶</h3>
    <p>æ¥æ”¶çš„æ¶ˆæ¯ï¼š{{ message }}</p>
    <p>æ¥æ”¶çš„è®¡æ•°ï¼š{{ count }}</p>

    <input v-model="inputValue" placeholder="è¾“å…¥æ•°æ®">
    <button @click="sendToParent">å‘é€æ•°æ®ç»™çˆ¶ç»„ä»¶</button>
    <button @click="incrementCount">å¢åŠ è®¡æ•°</button>
  </div>
</template>

<script setup>
import { ref } from 'vue';

// å®šä¹‰props
const props = defineProps({
  message: {
    type: String,
    required: true,
    default: ''
  },
  count: {
    type: Number,
    default: 0
  }
});

// å®šä¹‰emits
const emit = defineEmits(['update', 'increment']);

// å­ç»„ä»¶çš„æ•°æ®
const inputValue = ref('');

// å‘çˆ¶ç»„ä»¶å‘é€æ•°æ®
const sendToParent = () => {
  emit('update', inputValue.value);
};

// å¢åŠ è®¡æ•°å¹¶é€šçŸ¥çˆ¶ç»„ä»¶
const incrementCount = () => {
  emit('increment', props.count + 1);
};
</script>
```

#### Vue2 å†™æ³•å¯¹æ¯”

**çˆ¶ç»„ä»¶ï¼ˆVue2ï¼‰ï¼š**
```vue
<template>
  <div class="parent">
    <h2>çˆ¶ç»„ä»¶</h2>
    <p>çˆ¶ç»„ä»¶çš„æ•°æ®ï¼š{{ parentMessage }}</p>
    <p>ä»å­ç»„ä»¶æ¥æ”¶çš„æ•°æ®ï¼š{{ childData }}</p>

    <Child
      :message="parentMessage"
      :count="count"
      @update="handleUpdate"
    />
  </div>
</template>

<script>
import Child from './Child.vue';

export default {
  components: {
    Child
  },
  data() {
    return {
      parentMessage: 'è¿™æ˜¯æ¥è‡ªçˆ¶ç»„ä»¶çš„æ¶ˆæ¯',
      count: 0,
      childData: ''
    };
  },
  methods: {
    handleUpdate(data) {
      console.log('æ”¶åˆ°å­ç»„ä»¶çš„æ•°æ®:', data);
      this.childData = data;
    }
  }
};
</script>
```

**å­ç»„ä»¶ï¼ˆVue2ï¼‰ï¼š**
```vue
<template>
  <div class="child">
    <h3>å­ç»„ä»¶</h3>
    <p>æ¥æ”¶çš„æ¶ˆæ¯ï¼š{{ message }}</p>
    <p>æ¥æ”¶çš„è®¡æ•°ï¼š{{ count }}</p>

    <input v-model="inputValue" placeholder="è¾“å…¥æ•°æ®">
    <button @click="sendToParent">å‘é€æ•°æ®ç»™çˆ¶ç»„ä»¶</button>
  </div>
</template>

<script>
export default {
  props: {
    message: {
      type: String,
      required: true
    },
    count: {
      type: Number,
      default: 0
    }
  },
  data() {
    return {
      inputValue: ''
    };
  },
  methods: {
    sendToParent() {
      this.$emit('update', this.inputValue);
    }
  }
};
</script>
```

---

### 2. provide + injectï¼ˆè·¨çº§é€šä¿¡ï¼‰â­â­â­â­

**æ ¸å¿ƒå£è¯€ï¼šç¥–å…ˆprovideã€åä»£inject**

#### Vue3 å®Œæ•´ä»£ç ç¤ºä¾‹

**ç¥–å…ˆç»„ä»¶ï¼ˆAncestor.vueï¼‰ï¼š**
```vue
<template>
  <div class="ancestor">
    <h2>ç¥–å…ˆç»„ä»¶</h2>
    <p>ä¸»é¢˜: {{ theme }}</p>
    <p>ç”¨æˆ·: {{ user.name }} ({{ user.age }}å²)</p>

    <button @click="toggleTheme">åˆ‡æ¢ä¸»é¢˜</button>
    <button @click="updateUser">æ›´æ–°ç”¨æˆ·ä¿¡æ¯</button>

    <Parent />
  </div>
</template>

<script setup>
import { ref, provide, reactive } from 'vue';
import Parent from './Parent.vue';

// æä¾›æ™®é€šæ•°æ®
const theme = ref('light');
const toggleTheme = () => {
  theme.value = theme.value === 'light' ? 'dark' : 'light';
};

// æä¾›å“åº”å¼å¯¹è±¡
const user = reactive({
  name: 'å¼ ä¸‰',
  age: 25
});

const updateUser = () => {
  user.name = 'æå››';
  user.age = 30;
};

// æä¾›æ–¹æ³•
const updateTheme = (newTheme) => {
  theme.value = newTheme;
};

// ä½¿ç”¨provideæä¾›æ•°æ®
provide('theme', theme);
provide('user', user);
provide('updateTheme', updateTheme);
</script>
```

**ä¸­é—´ç»„ä»¶ï¼ˆParent.vueï¼‰ï¼š**
```vue
<template>
  <div class="parent">
    <h3>ä¸­é—´çˆ¶ç»„ä»¶ï¼ˆä¸éœ€è¦æ¥æ”¶æ•°æ®ï¼‰</h3>
    <Child />
  </div>
</template>

<script setup>
import Child from './Child.vue';
</script>
```

**åä»£ç»„ä»¶ï¼ˆChild.vueï¼‰ï¼š**
```vue
<template>
  <div class="child">
    <h4>åä»£ç»„ä»¶</h4>
    <p>æ¥æ”¶çš„ä¸»é¢˜: {{ theme }}</p>
    <p>æ¥æ”¶çš„ç”¨æˆ·: {{ user.name }} ({{ user.age }}å²)</p>

    <button @click="changeTheme">æ›´æ”¹ä¸»é¢˜ä¸ºblue</button>
  </div>
</template>

<script setup>
import { inject } from 'vue';

// ä½¿ç”¨injectæ¥æ”¶æ•°æ®
const theme = inject('theme');
const user = inject('user');
const updateTheme = inject('updateTheme');

// ä½¿ç”¨ç¥–å…ˆæä¾›çš„æ–¹æ³•
const changeTheme = () => {
  updateTheme('blue');
};
</script>
```

#### å“åº”å¼æ•°æ®å¤„ç†

**æ–¹å¼1ï¼šä½¿ç”¨ref/reactiveï¼ˆæ¨èï¼‰**
```javascript
// ç¥–å…ˆç»„ä»¶
import { ref, provide } from 'vue';

const count = ref(0);
provide('count', count);

// åä»£ç»„ä»¶
import { inject } from 'vue';
const count = inject('count');
// countæ˜¯å“åº”å¼çš„ï¼Œå˜åŒ–ä¼šè‡ªåŠ¨æ›´æ–°
```

**æ–¹å¼2ï¼šä½¿ç”¨readonlyä¿æŠ¤æ•°æ®**
```javascript
// ç¥–å…ˆç»„ä»¶
import { ref, provide, readonly } from 'vue';

const count = ref(0);
provide('count', readonly(count)); // åä»£åªè¯»ï¼Œä¸èƒ½ä¿®æ”¹

// æä¾›ä¿®æ”¹æ–¹æ³•
const increment = () => count.value++;
provide('increment', increment);
```

#### Vue2 å†™æ³•

**ç¥–å…ˆç»„ä»¶ï¼ˆVue2ï¼‰ï¼š**
```vue
<script>
export default {
  data() {
    return {
      theme: 'light',
      user: {
        name: 'å¼ ä¸‰',
        age: 25
      }
    };
  },
  provide() {
    return {
      theme: this.theme,
      user: this.user, // âš ï¸ Vue2ä¸­provideçš„æ•°æ®é»˜è®¤ä¸æ˜¯å“åº”å¼çš„
      updateTheme: this.updateTheme
    };
  },
  methods: {
    updateTheme(newTheme) {
      this.theme = newTheme;
    }
  }
};
</script>
```

**åä»£ç»„ä»¶ï¼ˆVue2ï¼‰ï¼š**
```vue
<script>
export default {
  inject: ['theme', 'user', 'updateTheme'],
  methods: {
    changeTheme() {
      this.updateTheme('blue');
    }
  }
};
</script>
```

**Vue2å“åº”å¼å¤„ç†ï¼š**
```javascript
// æ–¹å¼1ï¼šä½¿ç”¨å‡½æ•°è¿”å›
provide() {
  return {
    getTheme: () => this.theme // ä½¿ç”¨å‡½æ•°è¿”å›æœ€æ–°å€¼
  };
}

// æ–¹å¼2ï¼šä½¿ç”¨Vue.observableï¼ˆVue 2.6+ï¼‰
import Vue from 'vue';

provide() {
  this.state = Vue.observable({
    theme: 'light'
  });
  return {
    state: this.state
  };
}
```

---

### 3. v-modelï¼ˆåŒå‘ç»‘å®šï¼‰â­â­â­â­â­

**æ ¸å¿ƒå£è¯€ï¼šv-modelæœ¬è´¨æ˜¯propsåŠ emitçš„è¯­æ³•ç³–**

#### v-modelçš„åŸç†

```vue
<!-- ä»¥ä¸‹ä¸¤ç§å†™æ³•å®Œå…¨ç­‰ä»· -->

<!-- ç®€å†™å½¢å¼ -->
<Child v-model="value" />

<!-- å®Œæ•´å½¢å¼ï¼ˆVue3ï¼‰ -->
<Child
  :modelValue="value"
  @update:modelValue="value = $event"
/>

<!-- å®Œæ•´å½¢å¼ï¼ˆVue2ï¼‰ -->
<Child
  :value="value"
  @input="value = $event"
/>
```

#### Vue3 å®Œæ•´ä»£ç ç¤ºä¾‹

**çˆ¶ç»„ä»¶ï¼š**
```vue
<template>
  <div class="parent">
    <h2>çˆ¶ç»„ä»¶</h2>
    <p>è¾“å…¥æ¡†çš„å€¼: {{ inputValue }}</p>
    <p>å¼€å…³çŠ¶æ€: {{ switchValue }}</p>

    <!-- å•ä¸ªv-model -->
    <CustomInput v-model="inputValue" />

    <!-- å¤šä¸ªv-model -->
    <UserForm
      v-model:name="userName"
      v-model:age="userAge"
      v-model:email="userEmail"
    />

    <!-- è‡ªå®šä¹‰ä¿®é¥°ç¬¦ -->
    <CustomInput v-model.capitalize="inputValue" />
  </div>
</template>

<script setup>
import { ref } from 'vue';
import CustomInput from './CustomInput.vue';
import UserForm from './UserForm.vue';

const inputValue = ref('');
const switchValue = ref(false);
const userName = ref('');
const userAge = ref(0);
const userEmail = ref('');
</script>
```

**å­ç»„ä»¶ï¼ˆCustomInput.vueï¼‰ï¼š**
```vue
<template>
  <div class="custom-input">
    <input
      :value="modelValue"
      @input="handleInput"
      placeholder="è¯·è¾“å…¥å†…å®¹"
    />
  </div>
</template>

<script setup>
// å®šä¹‰propsï¼Œæ¥æ”¶v-modelä¼ æ¥çš„å€¼
const props = defineProps({
  modelValue: {
    type: String,
    default: ''
  },
  // è‡ªå®šä¹‰ä¿®é¥°ç¬¦
  modelModifiers: {
    default: () => ({})
  }
});

// å®šä¹‰emitï¼Œç”¨äºæ›´æ–°v-modelçš„å€¼
const emit = defineEmits(['update:modelValue']);

// å¤„ç†è¾“å…¥äº‹ä»¶
const handleInput = (event) => {
  let value = event.target.value;

  // å¤„ç†capitalizeä¿®é¥°ç¬¦
  if (props.modelModifiers.capitalize) {
    value = value.charAt(0).toUpperCase() + value.slice(1);
  }

  // è§¦å‘æ›´æ–°
  emit('update:modelValue', value);
};
</script>
```

**å­ç»„ä»¶ï¼ˆå¼€å…³ç»„ä»¶ï¼‰ï¼š**
```vue
<template>
  <div class="custom-switch" @click="toggle">
    <span :class="['switch', { active: modelValue }]"></span>
    <span>{{ modelValue ? 'å¼€' : 'å…³' }}</span>
  </div>
</template>

<script setup>
const props = defineProps({
  modelValue: {
    type: Boolean,
    default: false
  }
});

const emit = defineEmits(['update:modelValue']);

const toggle = () => {
  emit('update:modelValue', !props.modelValue);
};
</script>

<style scoped>
.switch {
  display: inline-block;
  width: 40px;
  height: 20px;
  background: #ccc;
  border-radius: 10px;
  position: relative;
  transition: background 0.3s;
}

.switch::after {
  content: '';
  position: absolute;
  width: 18px;
  height: 18px;
  border-radius: 50%;
  background: white;
  top: 1px;
  left: 1px;
  transition: left 0.3s;
}

.switch.active {
  background: #42b983;
}

.switch.active::after {
  left: 21px;
}
</style>
```

#### å¤šä¸ªv-modelï¼ˆVue3ç‹¬æœ‰ï¼‰

**çˆ¶ç»„ä»¶ï¼š**
```vue
<template>
  <div>
    <UserForm
      v-model:name="userName"
      v-model:age="userAge"
      v-model:email="userEmail"
    />

    <p>ç”¨æˆ·å: {{ userName }}</p>
    <p>å¹´é¾„: {{ userAge }}</p>
    <p>é‚®ç®±: {{ userEmail }}</p>
  </div>
</template>

<script setup>
import { ref } from 'vue';

const userName = ref('');
const userAge = ref(0);
const userEmail = ref('');
</script>
```

**å­ç»„ä»¶ï¼ˆUserForm.vueï¼‰ï¼š**
```vue
<template>
  <div class="user-form">
    <div>
      <label>å§“å:</label>
      <input
        :value="name"
        @input="$emit('update:name', $event.target.value)"
      />
    </div>

    <div>
      <label>å¹´é¾„:</label>
      <input
        type="number"
        :value="age"
        @input="$emit('update:age', Number($event.target.value))"
      />
    </div>

    <div>
      <label>é‚®ç®±:</label>
      <input
        type="email"
        :value="email"
        @input="$emit('update:email', $event.target.value)"
      />
    </div>
  </div>
</template>

<script setup>
defineProps({
  name: String,
  age: Number,
  email: String
});

defineEmits(['update:name', 'update:age', 'update:email']);
</script>
```

#### Vue2 v-model

**Vue2ä¸­v-modelç­‰ä»·äºï¼š**
```vue
<!-- ç®€å†™ -->
<CustomInput v-model="value" />

<!-- å®Œæ•´å†™æ³• -->
<CustomInput
  :value="value"
  @input="value = $event"
/>
```

**å­ç»„ä»¶ï¼ˆVue2ï¼‰ï¼š**
```vue
<template>
  <input
    :value="value"
    @input="$emit('input', $event.target.value)"
  />
</template>

<script>
export default {
  props: {
    value: {
      type: String,
      default: ''
    }
  }
};
</script>
```

**Vue2è‡ªå®šä¹‰propå’Œeventåç§°ï¼š**
```vue
<script>
export default {
  model: {
    prop: 'checked',
    event: 'change'
  },
  props: {
    checked: Boolean
  },
  methods: {
    toggle() {
      this.$emit('change', !this.checked);
    }
  }
};
</script>
```

### è®°å¿†å£è¯€

```
çˆ¶å­é€šä¿¡propsåŠ emitã€æ•°æ®ä¸‹ä¼ äº‹ä»¶ä¸ŠæŠ›
è·¨çº§é€šä¿¡provide injectã€ç¥–å…ˆåä»£ä¸éœ€æ¡¥
v-modelåŒå‘ç»‘å®šã€æœ¬è´¨è¿˜æ˜¯propså’Œemit
å¤šä¸ªv-model Vue3ä¸“å±ã€è‡ªå®šä¹‰ä¿®é¥°ç¬¦ä¹Ÿå¾ˆå¼º
```

---

## äºŒã€Vueç”Ÿå‘½å‘¨æœŸ

### Vue2 vs Vue3 å®Œæ•´å¯¹æ¯”

**é‡è¦æ€§ï¼šâ­â­â­â­â­ å¿…é¡»æŒæ¡**

| é˜¶æ®µ | Vue2 Options API | Vue3 Composition API | è°ƒç”¨æ—¶æœº | å¸¸è§ç”¨é€” |
|------|-----------------|---------------------|---------|---------|
| **åˆ›å»ºå‰** | beforeCreate | setup | å®ä¾‹åˆå§‹åŒ–å | - |
| **åˆ›å»ºå** | created | setup | æ•°æ®è§‚æµ‹ã€å±æ€§è®¡ç®—å®Œæˆ | æ•°æ®åˆå§‹åŒ–ã€APIè°ƒç”¨ |
| **æŒ‚è½½å‰** | beforeMount | onBeforeMount | æ¸²æŸ“åˆ°DOMå‰ | - |
| **æŒ‚è½½å** | mounted | onMounted | æ¸²æŸ“åˆ°DOMå | DOMæ“ä½œã€ç¬¬ä¸‰æ–¹åº“åˆå§‹åŒ– |
| **æ›´æ–°å‰** | beforeUpdate | onBeforeUpdate | æ•°æ®æ›´æ–°ï¼ŒDOMæ›´æ–°å‰ | è®¿é—®æ›´æ–°å‰çš„DOM |
| **æ›´æ–°å** | updated | onUpdated | DOMæ›´æ–°å | æ“ä½œæ›´æ–°åçš„DOM |
| **é”€æ¯å‰** | beforeDestroy | onBeforeUnmount | å®ä¾‹é”€æ¯å‰ | æ¸…ç†å®šæ—¶å™¨ã€äº‹ä»¶ç›‘å¬ |
| **é”€æ¯å** | destroyed | onUnmounted | å®ä¾‹é”€æ¯å | æœ€åçš„æ¸…ç†å·¥ä½œ |
| **æ¿€æ´»** | activated | onActivated | keep-aliveç»„ä»¶æ¿€æ´» | æ¢å¤æ•°æ®ã€é‡æ–°è·å–æ•°æ® |
| **åœç”¨** | deactivated | onDeactivated | keep-aliveç»„ä»¶åœç”¨ | ä¿å­˜çŠ¶æ€ |
| **é”™è¯¯æ•è·** | errorCaptured | onErrorCaptured | æ•è·å­ç»„ä»¶é”™è¯¯ | é”™è¯¯å¤„ç† |

### ç”Ÿå‘½å‘¨æœŸè¯¦ç»†è¯´æ˜

#### 1. åˆ›å»ºé˜¶æ®µ

**beforeCreateï¼ˆVue2ï¼‰/ setupï¼ˆVue3ï¼‰**
- **æ—¶æœº**ï¼šå®ä¾‹åˆå§‹åŒ–åï¼Œæ•°æ®è§‚æµ‹å’Œäº‹ä»¶é…ç½®ä¹‹å‰
- **ç‰¹ç‚¹**ï¼šæ— æ³•è®¿é—®dataã€computedã€methods
- **ç”¨é€”**ï¼šå¾ˆå°‘ä½¿ç”¨

**createdï¼ˆVue2ï¼‰/ setupï¼ˆVue3ï¼‰**
- **æ—¶æœº**ï¼šå®ä¾‹åˆ›å»ºå®Œæˆï¼Œæ•°æ®è§‚æµ‹ã€å±æ€§è®¡ç®—ã€æ–¹æ³•é…ç½®å®Œæˆ
- **ç‰¹ç‚¹**ï¼šå¯ä»¥è®¿é—®dataã€computedã€methodsï¼Œä½†æ— æ³•è®¿é—®DOM
- **ç”¨é€”**ï¼šæ•°æ®åˆå§‹åŒ–ã€è°ƒç”¨APIè·å–æ•°æ®

**ä»£ç ç¤ºä¾‹ï¼ˆVue2ï¼‰ï¼š**
```javascript
export default {
  data() {
    return {
      message: 'Hello'
    };
  },
  beforeCreate() {
    console.log('beforeCreate');
    console.log(this.message); // undefined
  },
  created() {
    console.log('created');
    console.log(this.message); // 'Hello'

    // å¸¸è§ç”¨é€”ï¼šè·å–æ•°æ®
    this.fetchData();
  },
  methods: {
    async fetchData() {
      const data = await fetch('/api/data');
      this.data = data;
    }
  }
};
```

**ä»£ç ç¤ºä¾‹ï¼ˆVue3ï¼‰ï¼š**
```javascript
import { ref, onMounted } from 'vue';

export default {
  setup() {
    const message = ref('Hello');

    // setupç›¸å½“äºbeforeCreate + created
    console.log('setup');
    console.log(message.value); // 'Hello'

    // æ•°æ®åˆå§‹åŒ–
    const data = ref([]);

    // è·å–æ•°æ®
    const fetchData = async () => {
      const response = await fetch('/api/data');
      data.value = await response.json();
    };

    // ç«‹å³è°ƒç”¨
    fetchData();

    return {
      message,
      data
    };
  }
};
```

#### 2. æŒ‚è½½é˜¶æ®µ

**beforeMountï¼ˆVue2ï¼‰/ onBeforeMountï¼ˆVue3ï¼‰**
- **æ—¶æœº**ï¼šåœ¨æŒ‚è½½å¼€å§‹ä¹‹å‰è¢«è°ƒç”¨ï¼Œrenderå‡½æ•°é¦–æ¬¡è¢«è°ƒç”¨
- **ç‰¹ç‚¹**ï¼šè™šæ‹ŸDOMå·²åˆ›å»ºï¼ŒçœŸå®DOMæœªç”Ÿæˆ
- **ç”¨é€”**ï¼šå¾ˆå°‘ä½¿ç”¨

**mountedï¼ˆVue2ï¼‰/ onMountedï¼ˆVue3ï¼‰â­â­â­â­â­**
- **æ—¶æœº**ï¼šå®ä¾‹è¢«æŒ‚è½½åˆ°DOMåè°ƒç”¨
- **ç‰¹ç‚¹**ï¼šå¯ä»¥è®¿é—®DOMå…ƒç´ ã€$refså¯ç”¨
- **ç”¨é€”**ï¼šDOMæ“ä½œã€ç¬¬ä¸‰æ–¹åº“åˆå§‹åŒ–ã€è·å–DOMä¿¡æ¯

**ä»£ç ç¤ºä¾‹ï¼ˆVue2ï¼‰ï¼š**
```javascript
export default {
  data() {
    return {
      chartInstance: null
    };
  },
  mounted() {
    console.log('mounted');

    // 1. DOMæ“ä½œ
    const element = this.$refs.myElement;
    console.log(element); // å¯ä»¥è®¿é—®DOMå…ƒç´ 

    // 2. åˆå§‹åŒ–ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚å›¾è¡¨åº“ï¼‰
    this.initChart();

    // 3. æ·»åŠ äº‹ä»¶ç›‘å¬
    window.addEventListener('resize', this.handleResize);

    // 4. è·å–DOMå°ºå¯¸
    const width = this.$refs.container.offsetWidth;
    console.log('å®¹å™¨å®½åº¦:', width);
  },
  methods: {
    initChart() {
      // åˆå§‹åŒ–å›¾è¡¨
      this.chartInstance = new Chart(this.$refs.chart, {
        // é…ç½®...
      });
    },
    handleResize() {
      // å¤„ç†çª—å£å¤§å°å˜åŒ–
    }
  },
  beforeDestroy() {
    // æ¸…ç†
    window.removeEventListener('resize', this.handleResize);
    if (this.chartInstance) {
      this.chartInstance.destroy();
    }
  }
};
```

**ä»£ç ç¤ºä¾‹ï¼ˆVue3ï¼‰ï¼š**
```vue
<template>
  <div ref="container">
    <canvas ref="chart"></canvas>
  </div>
</template>

<script setup>
import { ref, onMounted, onBeforeUnmount } from 'vue';

const container = ref(null);
const chart = ref(null);
let chartInstance = null;

onMounted(() => {
  console.log('onMounted');

  // 1. DOMæ“ä½œ
  console.log(container.value); // è®¿é—®DOMå…ƒç´ 

  // 2. åˆå§‹åŒ–ç¬¬ä¸‰æ–¹åº“
  chartInstance = new Chart(chart.value, {
    // é…ç½®...
  });

  // 3. æ·»åŠ äº‹ä»¶ç›‘å¬
  window.addEventListener('resize', handleResize);

  // 4. è·å–DOMå°ºå¯¸
  const width = container.value.offsetWidth;
  console.log('å®¹å™¨å®½åº¦:', width);

  // 5. æ»šåŠ¨åˆ°æŒ‡å®šä½ç½®
  window.scrollTo(0, 0);

  // 6. èšç„¦è¾“å…¥æ¡†
  const input = document.querySelector('input');
  input?.focus();
});

const handleResize = () => {
  // å¤„ç†çª—å£å¤§å°å˜åŒ–
  if (chartInstance) {
    chartInstance.resize();
  }
};

onBeforeUnmount(() => {
  // æ¸…ç†
  window.removeEventListener('resize', handleResize);
  if (chartInstance) {
    chartInstance.destroy();
  }
});
</script>
```

#### 3. æ›´æ–°é˜¶æ®µ

**beforeUpdateï¼ˆVue2ï¼‰/ onBeforeUpdateï¼ˆVue3ï¼‰**
- **æ—¶æœº**ï¼šæ•°æ®æ›´æ–°æ—¶è°ƒç”¨ï¼Œå‘ç”Ÿåœ¨è™šæ‹ŸDOMé‡æ–°æ¸²æŸ“ä¹‹å‰
- **ç‰¹ç‚¹**ï¼šå¯ä»¥è®¿é—®æ›´æ–°å‰çš„DOM
- **ç”¨é€”**ï¼šè·å–æ›´æ–°å‰çš„DOMçŠ¶æ€

**updatedï¼ˆVue2ï¼‰/ onUpdatedï¼ˆVue3ï¼‰**
- **æ—¶æœº**ï¼šè™šæ‹ŸDOMé‡æ–°æ¸²æŸ“åè°ƒç”¨
- **ç‰¹ç‚¹**ï¼šå¯ä»¥è®¿é—®æ›´æ–°åçš„DOM
- **ç”¨é€”**ï¼šæ“ä½œæ›´æ–°åçš„DOM
- **âš ï¸æ³¨æ„**ï¼šé¿å…åœ¨updatedä¸­ä¿®æ”¹æ•°æ®ï¼Œä¼šå¯¼è‡´æ— é™å¾ªç¯

**ä»£ç ç¤ºä¾‹ï¼š**
```javascript
// Vue3
import { ref, onBeforeUpdate, onUpdated } from 'vue';

const count = ref(0);
let prevHeight = 0;

onBeforeUpdate(() => {
  // è®°å½•æ›´æ–°å‰çš„é«˜åº¦
  const element = document.querySelector('.content');
  prevHeight = element?.offsetHeight || 0;
});

onUpdated(() => {
  // æ¯”è¾ƒæ›´æ–°åçš„é«˜åº¦
  const element = document.querySelector('.content');
  const newHeight = element?.offsetHeight || 0;

  if (newHeight !== prevHeight) {
    console.log('é«˜åº¦å˜åŒ–:', prevHeight, '->', newHeight);
  }
});
```

#### 4. é”€æ¯é˜¶æ®µâ­â­â­â­â­

**beforeDestroyï¼ˆVue2ï¼‰/ onBeforeUnmountï¼ˆVue3ï¼‰**
- **æ—¶æœº**ï¼šå®ä¾‹é”€æ¯å‰è°ƒç”¨
- **ç‰¹ç‚¹**ï¼šå®ä¾‹ä»ç„¶å®Œå…¨å¯ç”¨
- **ç”¨é€”**ï¼šæ¸…ç†å®šæ—¶å™¨ã€äº‹ä»¶ç›‘å¬ã€ç¬¬ä¸‰æ–¹åº“å®ä¾‹

**destroyedï¼ˆVue2ï¼‰/ onUnmountedï¼ˆVue3ï¼‰**
- **æ—¶æœº**ï¼šå®ä¾‹é”€æ¯åè°ƒç”¨
- **ç‰¹ç‚¹**ï¼šæ‰€æœ‰æŒ‡ä»¤è§£ç»‘ã€äº‹ä»¶ç›‘å¬å™¨ç§»é™¤ã€å­å®ä¾‹é”€æ¯
- **ç”¨é€”**ï¼šæœ€åçš„æ¸…ç†å·¥ä½œ

**ä»£ç ç¤ºä¾‹ï¼ˆVue2ï¼‰ï¼š**
```javascript
export default {
  data() {
    return {
      timer: null,
      observer: null
    };
  },
  mounted() {
    // è®¾ç½®å®šæ—¶å™¨
    this.timer = setInterval(() => {
      console.log('å®šæ—¶æ‰§è¡Œ');
    }, 1000);

    // åˆ›å»ºè§‚å¯Ÿå™¨
    this.observer = new IntersectionObserver(entries => {
      // å¤„ç†...
    });
    this.observer.observe(this.$refs.element);

    // æ·»åŠ äº‹ä»¶ç›‘å¬
    window.addEventListener('scroll', this.handleScroll);
  },
  beforeDestroy() {
    // æ¸…ç†å®šæ—¶å™¨
    if (this.timer) {
      clearInterval(this.timer);
      this.timer = null;
    }

    // æ¸…ç†è§‚å¯Ÿå™¨
    if (this.observer) {
      this.observer.disconnect();
      this.observer = null;
    }

    // ç§»é™¤äº‹ä»¶ç›‘å¬
    window.removeEventListener('scroll', this.handleScroll);

    // æ¸…ç†ç¬¬ä¸‰æ–¹åº“
    if (this.chartInstance) {
      this.chartInstance.destroy();
    }
  }
};
```

**ä»£ç ç¤ºä¾‹ï¼ˆVue3ï¼‰ï¼š**
```vue
<script setup>
import { ref, onMounted, onBeforeUnmount } from 'vue';

let timer = null;
let observer = null;

onMounted(() => {
  // è®¾ç½®å®šæ—¶å™¨
  timer = setInterval(() => {
    console.log('å®šæ—¶æ‰§è¡Œ');
  }, 1000);

  // åˆ›å»ºè§‚å¯Ÿå™¨
  observer = new IntersectionObserver(entries => {
    // å¤„ç†...
  });
  const element = document.querySelector('.element');
  observer.observe(element);

  // æ·»åŠ äº‹ä»¶ç›‘å¬
  window.addEventListener('scroll', handleScroll);
});

const handleScroll = () => {
  // å¤„ç†æ»šåŠ¨
};

onBeforeUnmount(() => {
  // æ¸…ç†å®šæ—¶å™¨
  if (timer) {
    clearInterval(timer);
    timer = null;
  }

  // æ¸…ç†è§‚å¯Ÿå™¨
  if (observer) {
    observer.disconnect();
    observer = null;
  }

  // ç§»é™¤äº‹ä»¶ç›‘å¬
  window.removeEventListener('scroll', handleScroll);
});
</script>
```

#### 5. keep-aliveä¸“å±

**activatedï¼ˆVue2ï¼‰/ onActivatedï¼ˆVue3ï¼‰**
- **æ—¶æœº**ï¼šè¢«keep-aliveç¼“å­˜çš„ç»„ä»¶æ¿€æ´»æ—¶è°ƒç”¨
- **ç”¨é€”**ï¼šæ¢å¤æ•°æ®ã€é‡æ–°è·å–æ•°æ®

**deactivatedï¼ˆVue2ï¼‰/ onDeactivatedï¼ˆVue3ï¼‰**
- **æ—¶æœº**ï¼šè¢«keep-aliveç¼“å­˜çš„ç»„ä»¶åœç”¨æ—¶è°ƒç”¨
- **ç”¨é€”**ï¼šä¿å­˜çŠ¶æ€ã€æ¸…ç†ä¸´æ—¶æ•°æ®

**ä»£ç ç¤ºä¾‹ï¼š**
```vue
<template>
  <keep-alive>
    <component :is="currentComponent"></component>
  </keep-alive>
</template>

<script setup>
import { onActivated, onDeactivated } from 'vue';

onActivated(() => {
  console.log('ç»„ä»¶è¢«æ¿€æ´»');
  // æ¢å¤æ•°æ®ã€é‡æ–°è·å–æ•°æ®
  fetchData();
});

onDeactivated(() => {
  console.log('ç»„ä»¶è¢«åœç”¨');
  // ä¿å­˜æ»šåŠ¨ä½ç½®
  saveScrollPosition();
});
</script>
```

### è®°å¿†å£è¯€

```
åˆ›å»ºæŒ‚è½½æ›´æ–°é”€æ¯ï¼Œå››å¤§é˜¶æ®µè¦è®°ç‰¢
createdæ•°æ®åˆå§‹åŒ–ï¼Œmountedå¯æ“ä½œDOM
beforeUnmountæ¸…èµ„æºï¼Œå®šæ—¶äº‹ä»¶è¦ç§»é™¤
activated keep-aliveä¸“å±ï¼Œç»„ä»¶æ¿€æ´»æ—¶è°ƒç”¨
```

**Vue2 vs Vue3å¯¹ç…§å£è¯€ï¼š**
```
beforeCreate created å˜æˆ setup
beforeMount mounted åŠ ä¸Š on
beforeUpdate updated ä¹ŸåŠ  on
beforeDestroy destroyed æ”¹å Unmount
```

---

# ç¬¬ä¸‰éƒ¨åˆ†ï¼šJavaScriptè¿›é˜¶ï¼ˆå®Œæ•´è¯¦ç»†ï¼‰

## ä¸€ã€thisæŒ‡å‘

### äº”ç§ç»‘å®šè§„åˆ™â­â­â­â­â­

**é‡è¦æ€§ï¼šæé«˜é¢‘è€ƒç‚¹ï¼Œå¿…é¡»å®Œå…¨æŒæ¡**

**æ ¸å¿ƒå£è¯€ï¼šæ–°æ˜¾éšé»˜ç®­**
```
æ–°ï¼ˆnewï¼‰å»ºæ˜¾ï¼ˆcall/apply/bindï¼‰çœ¼ï¼ˆéšå¼ç»‘å®šï¼‰
é»˜ï¼ˆé»˜è®¤ç»‘å®šï¼‰è®¤æœ€ä½ï¼Œç®­ï¼ˆç®­å¤´å‡½æ•°ï¼‰å¤´çœ‹å¤–å±‚
```

**ä¼˜å…ˆçº§ï¼šnewç»‘å®š > æ˜¾å¼ç»‘å®š > éšå¼ç»‘å®š > é»˜è®¤ç»‘å®š**

### 1. é»˜è®¤ç»‘å®š

**è§„åˆ™ï¼š**
- ç‹¬ç«‹å‡½æ•°è°ƒç”¨ï¼ŒthisæŒ‡å‘å…¨å±€å¯¹è±¡
- éä¸¥æ ¼æ¨¡å¼ï¼šthisæŒ‡å‘window
- ä¸¥æ ¼æ¨¡å¼ï¼šthisæŒ‡å‘undefined

**å®Œæ•´ä»£ç ç¤ºä¾‹ï¼š**
```javascript
// éä¸¥æ ¼æ¨¡å¼
function fn() {
  console.log(this); // window
  console.log(this.name); // undefined
}
fn();

// ä¸¥æ ¼æ¨¡å¼
'use strict';
function fn2() {
  console.log(this); // undefined
}
fn2();

// å¯¹è±¡æ–¹æ³•èµ‹å€¼ç»™å˜é‡ï¼ˆéšå¼ç»‘å®šä¸¢å¤±ï¼‰
const obj = {
  name: 'å¼ ä¸‰',
  sayName: function() {
    console.log(this.name);
  }
};
const fn3 = obj.sayName;
fn3(); // undefinedï¼ˆthisæŒ‡å‘windowï¼‰
```

### 2. éšå¼ç»‘å®š

**è§„åˆ™ï¼š**
- å‡½æ•°ä½œä¸ºå¯¹è±¡æ–¹æ³•è°ƒç”¨
- thisæŒ‡å‘è°ƒç”¨è¯¥æ–¹æ³•çš„å¯¹è±¡
- âš ï¸ æ³¨æ„éšå¼ç»‘å®šä¸¢å¤±é—®é¢˜

**å®Œæ•´ä»£ç ç¤ºä¾‹ï¼š**
```javascript
// åŸºæœ¬ç”¨æ³•
const person = {
  name: 'æå››',
  age: 25,
  sayHello: function() {
    console.log(`æˆ‘æ˜¯${this.name}ï¼Œä»Šå¹´${this.age}å²`);
  },
  friend: {
    name: 'ç‹äº”',
    sayHello: function() {
      console.log(`æˆ‘æ˜¯${this.name}`);
    }
  }
};

person.sayHello(); // æˆ‘æ˜¯æå››ï¼Œä»Šå¹´25å²ï¼ˆthisæŒ‡å‘personï¼‰
person.friend.sayHello(); // æˆ‘æ˜¯ç‹äº”ï¼ˆthisæŒ‡å‘friendå¯¹è±¡ï¼‰

// éšå¼ç»‘å®šä¸¢å¤± - æƒ…å†µ1ï¼šèµ‹å€¼
const fn = person.sayHello;
fn(); // æˆ‘æ˜¯undefinedï¼Œä»Šå¹´undefinedå²ï¼ˆthisæŒ‡å‘windowï¼‰

// éšå¼ç»‘å®šä¸¢å¤± - æƒ…å†µ2ï¼šä¼ å‚
function execute(callback) {
  callback();
}
execute(person.sayHello); // thisä¸¢å¤±

// éšå¼ç»‘å®šä¸¢å¤± - æƒ…å†µ3ï¼šsetTimeout
setTimeout(person.sayHello, 1000); // thisä¸¢å¤±

// è§£å†³æ–¹æ¡ˆ1ï¼šä½¿ç”¨ç®­å¤´å‡½æ•°
setTimeout(() => person.sayHello(), 1000); // æ­£ç¡®

// è§£å†³æ–¹æ¡ˆ2ï¼šä½¿ç”¨bind
setTimeout(person.sayHello.bind(person), 1000); // æ­£ç¡®
```

### 3. æ˜¾å¼ç»‘å®šï¼ˆcallã€applyã€bindï¼‰â­â­â­â­â­

**è§„åˆ™ï¼š**
- é€šè¿‡callã€applyã€bindæ‰‹åŠ¨æŒ‡å®šthis
- callå’Œapplyç«‹å³æ‰§è¡Œï¼Œbindè¿”å›æ–°å‡½æ•°

**å®Œæ•´ä»£ç ç¤ºä¾‹ï¼š**
```javascript
const person = {
  name: 'èµµå…­',
  age: 30
};

function introduce(city, hobby) {
  console.log(`æˆ‘æ˜¯${this.name}ï¼Œä»Šå¹´${this.age}å²ï¼Œæ¥è‡ª${city}ï¼Œçˆ±å¥½${hobby}`);
}

// call - å‚æ•°é€ä¸ªä¼ é€’
introduce.call(person, 'åŒ—äº¬', 'ç¯®çƒ');
// è¾“å‡ºï¼šæˆ‘æ˜¯èµµå…­ï¼Œä»Šå¹´30å²ï¼Œæ¥è‡ªåŒ—äº¬ï¼Œçˆ±å¥½ç¯®çƒ

// apply - å‚æ•°ä»¥æ•°ç»„ä¼ é€’
introduce.apply(person, ['ä¸Šæµ·', 'è¶³çƒ']);
// è¾“å‡ºï¼šæˆ‘æ˜¯èµµå…­ï¼Œä»Šå¹´30å²ï¼Œæ¥è‡ªä¸Šæµ·ï¼Œçˆ±å¥½è¶³çƒ

// bind - è¿”å›æ–°å‡½æ•°ï¼Œä¸ç«‹å³æ‰§è¡Œ
const boundIntroduce = introduce.bind(person, 'å¹¿å·');
boundIntroduce('æ¸¸æ³³');
// è¾“å‡ºï¼šæˆ‘æ˜¯èµµå…­ï¼Œä»Šå¹´30å²ï¼Œæ¥è‡ªå¹¿å·ï¼Œçˆ±å¥½æ¸¸æ³³

// bindçš„æŸ¯é‡ŒåŒ–
const partialIntroduce = introduce.bind(person);
partialIntroduce('æ·±åœ³', 'é˜…è¯»');
// è¾“å‡ºï¼šæˆ‘æ˜¯èµµå…­ï¼Œä»Šå¹´30å²ï¼Œæ¥è‡ªæ·±åœ³ï¼Œçˆ±å¥½é˜…è¯»

// å®é™…åº”ç”¨ï¼šäº‹ä»¶å¤„ç†
class Counter {
  constructor() {
    this.count = 0;
    this.element = document.getElementById('btn');

    // é”™è¯¯ï¼šthisä¸¢å¤±
    // this.element.addEventListener('click', this.increment);

    // æ­£ç¡®ï¼šä½¿ç”¨bind
    this.element.addEventListener('click', this.increment.bind(this));
  }

  increment() {
    this.count++;
    console.log(this.count);
  }
}
```

**callã€applyã€bindçš„åŒºåˆ«ï¼š**
```javascript
function greet(greeting, punctuation) {
  return `${greeting}, ${this.name}${punctuation}`;
}

const person = { name: 'å°æ˜' };

// callï¼šç«‹å³æ‰§è¡Œï¼Œå‚æ•°é€ä¸ªä¼ é€’
console.log(greet.call(person, 'Hello', '!'));
// Hello, å°æ˜!

// applyï¼šç«‹å³æ‰§è¡Œï¼Œå‚æ•°ä»¥æ•°ç»„ä¼ é€’
console.log(greet.apply(person, ['Hi', '~']));
// Hi, å°æ˜~

// bindï¼šè¿”å›æ–°å‡½æ•°ï¼Œä¸ç«‹å³æ‰§è¡Œ
const boundGreet = greet.bind(person, 'Hey');
console.log(boundGreet('?'));
// Hey, å°æ˜?

// bindå¯ä»¥åˆ†æ­¥ä¼ å‚ï¼ˆæŸ¯é‡ŒåŒ–ï¼‰
const boundGreet2 = greet.bind(person);
console.log(boundGreet2('Welcome', '.'));
// Welcome, å°æ˜.
```

### 4. newç»‘å®š

**è§„åˆ™ï¼š**
- ä½œä¸ºæ„é€ å‡½æ•°è°ƒç”¨ï¼ˆä½¿ç”¨newå…³é”®å­—ï¼‰
- thisæŒ‡å‘æ–°åˆ›å»ºçš„å®ä¾‹å¯¹è±¡

**å®Œæ•´ä»£ç ç¤ºä¾‹ï¼š**
```javascript
function Person(name, age) {
  this.name = name;
  this.age = age;
  this.sayHello = function() {
    console.log(`ä½ å¥½ï¼Œæˆ‘æ˜¯${this.name}`);
  };
}

const person1 = new Person('å­™ä¸ƒ', 28);
const person2 = new Person('å‘¨å…«', 32);

console.log(person1.name); // å­™ä¸ƒ
console.log(person2.name); // å‘¨å…«

person1.sayHello(); // ä½ å¥½ï¼Œæˆ‘æ˜¯å­™ä¸ƒ
person2.sayHello(); // ä½ å¥½ï¼Œæˆ‘æ˜¯å‘¨å…«

// newçš„æ‰§è¡Œè¿‡ç¨‹ï¼š
// 1. åˆ›å»ºä¸€ä¸ªæ–°çš„ç©ºå¯¹è±¡
// 2. å°†æ–°å¯¹è±¡çš„__proto__æŒ‡å‘æ„é€ å‡½æ•°çš„prototype
// 3. å°†æ„é€ å‡½æ•°çš„thisæŒ‡å‘æ–°å¯¹è±¡ï¼Œæ‰§è¡Œæ„é€ å‡½æ•°
// 4. å¦‚æœæ„é€ å‡½æ•°è¿”å›å¯¹è±¡ï¼Œåˆ™è¿”å›è¯¥å¯¹è±¡ï¼›å¦åˆ™è¿”å›æ–°å¯¹è±¡

// ç‰¹æ®Šæƒ…å†µï¼šæ„é€ å‡½æ•°è¿”å›å¯¹è±¡
function Person2(name) {
  this.name = name;
  return { name: 'å¼ºåˆ¶è¿”å›' }; // è¿”å›å…¶ä»–å¯¹è±¡
}

const p = new Person2('å´ä¹');
console.log(p.name); // å¼ºåˆ¶è¿”å›ï¼ˆè¿”å›çš„æ˜¯æ„é€ å‡½æ•°è¿”å›çš„å¯¹è±¡ï¼‰

// æ„é€ å‡½æ•°è¿”å›åŸºæœ¬ç±»å‹
function Person3(name) {
  this.name = name;
  return 'ignored'; // è¿”å›åŸºæœ¬ç±»å‹ï¼Œè¢«å¿½ç•¥
}

const p2 = new Person3('éƒ‘å');
console.log(p2.name); // éƒ‘åï¼ˆè¿”å›çš„æ˜¯æ–°åˆ›å»ºçš„å¯¹è±¡ï¼‰
```

### 5. ç®­å¤´å‡½æ•°

**è§„åˆ™ï¼š**
- ç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„this
- thisç»§æ‰¿è‡ªå¤–å±‚ä½œç”¨åŸŸï¼ˆå®šä¹‰æ—¶æ‰€åœ¨çš„ä½œç”¨åŸŸï¼‰
- ä¸èƒ½é€šè¿‡callã€applyã€bindæ”¹å˜thisæŒ‡å‘
- ä¸èƒ½ä½œä¸ºæ„é€ å‡½æ•°ä½¿ç”¨

**å®Œæ•´ä»£ç ç¤ºä¾‹ï¼š**
```javascript
// ä¾‹1ï¼šç®­å¤´å‡½æ•°ç»§æ‰¿å¤–å±‚this
const obj = {
  name: 'å¯¹è±¡',
  // æ™®é€šå‡½æ•°
  fn1: function() {
    console.log(this.name); // 'å¯¹è±¡'
  },
  // ç®­å¤´å‡½æ•°
  fn2: () => {
    console.log(this.name); // undefinedï¼ˆthisæŒ‡å‘windowï¼‰
  },
  // åµŒå¥—ï¼šæ™®é€šå‡½æ•° + ç®­å¤´å‡½æ•°
  fn3: function() {
    const arrow = () => {
      console.log(this.name); // 'å¯¹è±¡'ï¼ˆç»§æ‰¿fn3çš„thisï¼‰
    };
    arrow();
  },
  // åµŒå¥—ï¼šç®­å¤´å‡½æ•° + ç®­å¤´å‡½æ•°
  fn4: () => {
    const arrow = () => {
      console.log(this.name); // undefinedï¼ˆç»§æ‰¿fn4çš„thisï¼Œå³windowï¼‰
    };
    arrow();
  }
};

obj.fn1(); // 'å¯¹è±¡'
obj.fn2(); // undefined
obj.fn3(); // 'å¯¹è±¡'
obj.fn4(); // undefined

// ä¾‹2ï¼šå®šæ—¶å™¨ä¸­çš„this
const counter = {
  count: 0,
  // é”™è¯¯ï¼šæ™®é€šå‡½æ•°ï¼Œthisä¸¢å¤±
  start1: function() {
    setInterval(function() {
      this.count++; // thisæŒ‡å‘window
      console.log(this.count); // NaN
    }, 1000);
  },
  // æ­£ç¡®ï¼šç®­å¤´å‡½æ•°ï¼Œç»§æ‰¿å¤–å±‚this
  start2: function() {
    setInterval(() => {
      this.count++; // thisæŒ‡å‘counter
      console.log(this.count); // 1, 2, 3...
    }, 1000);
  },
  // æ­£ç¡®ï¼šbindç»‘å®šthis
  start3: function() {
    setInterval(function() {
      this.count++;
      console.log(this.count);
    }.bind(this), 1000);
  }
};

// ä¾‹3ï¼šäº‹ä»¶å¤„ç†
class Button {
  constructor() {
    this.count = 0;
    this.element = document.getElementById('btn');

    // é”™è¯¯ï¼šthisä¸¢å¤±
    // this.element.addEventListener('click', this.handleClick);

    // æ­£ç¡®ï¼šç®­å¤´å‡½æ•°
    this.element.addEventListener('click', () => {
      this.handleClick();
    });

    // æˆ–è€…ä½¿ç”¨bind
    // this.element.addEventListener('click', this.handleClick.bind(this));
  }

  handleClick() {
    this.count++;
    console.log(this.count);
  }
}

// ä¾‹4ï¼šæ•°ç»„æ–¹æ³•ä¸­çš„this
const obj2 = {
  numbers: [1, 2, 3, 4, 5],
  multiplier: 2,

  // æ™®é€šå‡½æ•° + ç®­å¤´å‡½æ•°
  multiply1: function() {
    return this.numbers.map(num => num * this.multiplier);
  },

  // æ™®é€šå‡½æ•° + æ™®é€šå‡½æ•°ï¼ˆé”™è¯¯ï¼‰
  multiply2: function() {
    return this.numbers.map(function(num) {
      return num * this.multiplier; // thisæ˜¯undefined
    });
  },

  // æ™®é€šå‡½æ•° + æ™®é€šå‡½æ•° + thisArgå‚æ•°
  multiply3: function() {
    return this.numbers.map(function(num) {
      return num * this.multiplier;
    }, this); // ä¼ å…¥thisä½œä¸ºç¬¬äºŒä¸ªå‚æ•°
  }
};

console.log(obj2.multiply1()); // [2, 4, 6, 8, 10]
console.log(obj2.multiply2()); // [NaN, NaN, NaN, NaN, NaN]
console.log(obj2.multiply3()); // [2, 4, 6, 8, 10]

// ä¾‹5ï¼šç®­å¤´å‡½æ•°ä¸èƒ½ä½œä¸ºæ„é€ å‡½æ•°
const ArrowFunc = () => {};
// const instance = new ArrowFunc(); // TypeError: ArrowFunc is not a constructor

// ä¾‹6ï¼šç®­å¤´å‡½æ•°ä¸èƒ½é€šè¿‡call/apply/bindæ”¹å˜this
const obj3 = { name: 'obj3' };
const arrow = () => {
  console.log(this.name);
};

arrow.call(obj3); // undefinedï¼ˆæ— æ³•æ”¹å˜thisï¼‰
arrow.apply(obj3); // undefined
const boundArrow = arrow.bind(obj3);
boundArrow(); // undefined
```

### ä¼˜å…ˆçº§æ€»ç»“

```javascript
// ä¼˜å…ˆçº§ï¼šnew > æ˜¾å¼ç»‘å®š > éšå¼ç»‘å®š > é»˜è®¤ç»‘å®š

function fn() {
  console.log(this.name);
}

const obj = {
  name: 'å¯¹è±¡',
  fn: fn
};

const boundFn = fn.bind({ name: 'bindå¯¹è±¡' });

// 1. é»˜è®¤ç»‘å®šï¼ˆä¼˜å…ˆçº§æœ€ä½ï¼‰
fn(); // undefined

// 2. éšå¼ç»‘å®š
obj.fn(); // 'å¯¹è±¡'

// 3. æ˜¾å¼ç»‘å®šï¼ˆä¼˜å…ˆçº§é«˜äºéšå¼ç»‘å®šï¼‰
obj.fn.call({ name: 'callå¯¹è±¡' }); // 'callå¯¹è±¡'

// 4. bind vs callï¼ˆbindä¼˜å…ˆçº§ä½äºcallï¼‰
boundFn.call({ name: 'callå¯¹è±¡' }); // 'bindå¯¹è±¡'ï¼ˆbindå·²ç»å›ºå®šthisï¼‰

// 5. newç»‘å®šï¼ˆä¼˜å…ˆçº§æœ€é«˜ï¼‰
function Person(name) {
  this.name = name;
}
const boundPerson = Person.bind({ name: 'bindå¯¹è±¡' });
const p = new boundPerson('newå¯¹è±¡');
console.log(p.name); // 'newå¯¹è±¡'ï¼ˆnewä¼˜å…ˆçº§æœ€é«˜ï¼‰
```

### è®°å¿†å£è¯€

```
æ–°ï¼ˆnewï¼‰å»ºæ˜¾ï¼ˆcall/apply/bindï¼‰çœ¼ï¼ˆéšå¼ç»‘å®šï¼‰
é»˜ï¼ˆé»˜è®¤ç»‘å®šï¼‰è®¤æœ€ä½ï¼Œç®­ï¼ˆç®­å¤´å‡½æ•°ï¼‰å¤´çœ‹å¤–å±‚

é»˜è®¤ç»‘å®šï¼šç‹¬ç«‹è°ƒç”¨ï¼Œä¸¥æ ¼undefinedéä¸¥æ ¼window
éšå¼ç»‘å®šï¼šå¯¹è±¡æ–¹æ³•ï¼ŒthisæŒ‡å‘è°ƒç”¨å¯¹è±¡
æ˜¾å¼ç»‘å®šï¼šcall/apply/bindï¼Œæ‰‹åŠ¨æŒ‡å®šthis
newç»‘å®šï¼šæ„é€ å‡½æ•°ï¼ŒthisæŒ‡å‘æ–°å®ä¾‹
ç®­å¤´å‡½æ•°ï¼šæ²¡æœ‰thisï¼Œç»§æ‰¿å¤–å±‚ä½œç”¨åŸŸ
```

---

## äºŒã€ä½œç”¨åŸŸå’Œé—­åŒ…

### ä½œç”¨åŸŸä¸‰å…„å¼Ÿâ­â­â­â­

**æ ¸å¿ƒå£è¯€ï¼šå…¨å±€å‡½æ•°å—ï¼Œä»å¤§åˆ°å°æ‰¾å˜é‡**

#### 1. å…¨å±€ä½œç”¨åŸŸ

**ç‰¹ç‚¹ï¼š**
- åœ¨ä»»ä½•åœ°æ–¹éƒ½èƒ½è®¿é—®
- ç”Ÿå‘½å‘¨æœŸï¼šé¡µé¢æ‰“å¼€åˆ°å…³é—­
- windowå¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•

**ä»£ç ç¤ºä¾‹ï¼š**
```javascript
// å…¨å±€å˜é‡
var globalVar = 'å…¨å±€å˜é‡';
let globalLet = 'å…¨å±€let';
const globalConst = 'å…¨å±€const';

function fn() {
  console.log(globalVar); // å¯ä»¥è®¿é—®
  console.log(globalLet); // å¯ä»¥è®¿é—®
  console.log(globalConst); // å¯ä»¥è®¿é—®
}

// windowå¯¹è±¡çš„å±æ€§
console.log(window.globalVar); // 'å…¨å±€å˜é‡'
console.log(window.globalLet); // undefinedï¼ˆletä¸ä¼šæŒ‚è½½åˆ°windowï¼‰
console.log(window.globalConst); // undefinedï¼ˆconstä¸ä¼šæŒ‚è½½åˆ°windowï¼‰

// ä¸ä½¿ç”¨var/let/constå£°æ˜çš„å˜é‡ä¼šæˆä¸ºå…¨å±€å˜é‡ï¼ˆä¸æ¨èï¼‰
function createGlobal() {
  implicitGlobal = 'éšå¼å…¨å±€å˜é‡';
}
createGlobal();
console.log(implicitGlobal); // 'éšå¼å…¨å±€å˜é‡'
console.log(window.implicitGlobal); // 'éšå¼å…¨å±€å˜é‡'
```

#### 2. å‡½æ•°ä½œç”¨åŸŸ

**ç‰¹ç‚¹ï¼š**
- åªåœ¨å‡½æ•°å†…éƒ¨è®¿é—®
- å‡½æ•°æ‰§è¡Œæ—¶åˆ›å»ºï¼Œæ‰§è¡Œç»“æŸåé”€æ¯
- varã€letã€constå£°æ˜çš„å˜é‡éƒ½æ˜¯å‡½æ•°ä½œç”¨åŸŸ

**ä»£ç ç¤ºä¾‹ï¼š**
```javascript
function outer() {
  var a = 1;
  let b = 2;
  const c = 3;

  function inner() {
    console.log(a); // 1ï¼ˆå¯ä»¥è®¿é—®å¤–å±‚å‡½æ•°çš„å˜é‡ï¼‰
    console.log(b); // 2
    console.log(c); // 3
  }

  inner();
}

outer();
// console.log(a); // ReferenceError: a is not defined
// console.log(b); // ReferenceError: b is not defined
// console.log(c); // ReferenceError: c is not defined

// å‡½æ•°å‚æ•°ä¹Ÿæ˜¯å‡½æ•°ä½œç”¨åŸŸ
function fn(param) {
  console.log(param); // å¯ä»¥è®¿é—®
}
// console.log(param); // ReferenceError: param is not defined
```

#### 3. å—çº§ä½œç”¨åŸŸï¼ˆES6ï¼‰

**ç‰¹ç‚¹ï¼š**
- åªåœ¨ä»£ç å—{}å†…æœ‰æ•ˆ
- letå’Œconstå£°æ˜çš„å˜é‡æ˜¯å—çº§ä½œç”¨åŸŸ
- varå£°æ˜çš„å˜é‡ä¸æ˜¯å—çº§ä½œç”¨åŸŸ

**ä»£ç ç¤ºä¾‹ï¼š**
```javascript
// ifå—çº§ä½œç”¨åŸŸ
if (true) {
  var a = 1;
  let b = 2;
  const c = 3;
}
console.log(a); // 1ï¼ˆvarä¸æ˜¯å—çº§ä½œç”¨åŸŸï¼‰
// console.log(b); // ReferenceErrorï¼ˆletæ˜¯å—çº§ä½œç”¨åŸŸï¼‰
// console.log(c); // ReferenceErrorï¼ˆconstæ˜¯å—çº§ä½œç”¨åŸŸï¼‰

// forå¾ªç¯å—çº§ä½œç”¨åŸŸ
for (var i = 0; i < 3; i++) {
  setTimeout(() => console.log(i), 1000);
}
// è¾“å‡ºï¼š3 3 3ï¼ˆvarä¸æ˜¯å—çº§ä½œç”¨åŸŸï¼Œiè¢«å…±äº«ï¼‰

for (let j = 0; j < 3; j++) {
  setTimeout(() => console.log(j), 1000);
}
// è¾“å‡ºï¼š0 1 2ï¼ˆletæ˜¯å—çº§ä½œç”¨åŸŸï¼Œæ¯æ¬¡å¾ªç¯éƒ½æ˜¯ç‹¬ç«‹çš„jï¼‰

// switchå—çº§ä½œç”¨åŸŸ
switch (1) {
  case 1:
    let x = 10;
    console.log(x); // 10
    break;
  case 2:
    // let x = 20; // SyntaxError: Identifier 'x' has already been declared
    break;
}

// å•ç‹¬çš„{}ä¹Ÿæ˜¯å—çº§ä½œç”¨åŸŸ
{
  let blockVar = 'block';
  console.log(blockVar); // 'block'
}
// console.log(blockVar); // ReferenceError
```

### ä½œç”¨åŸŸé“¾

**æ¦‚å¿µï¼š**
å½“æŸ¥æ‰¾å˜é‡æ—¶ï¼Œä»å½“å‰ä½œç”¨åŸŸå¼€å§‹ï¼Œé€çº§å‘ä¸ŠæŸ¥æ‰¾ï¼Œç›´åˆ°å…¨å±€ä½œç”¨åŸŸï¼Œå½¢æˆçš„é“¾å¼ç»“æ„å«ä½œç”¨åŸŸé“¾ã€‚

**ä»£ç ç¤ºä¾‹ï¼š**
```javascript
var a = 1; // å…¨å±€ä½œç”¨åŸŸ

function outer() {
  var b = 2; // outerå‡½æ•°ä½œç”¨åŸŸ

  function middle() {
    var c = 3; // middleå‡½æ•°ä½œç”¨åŸŸ

    function inner() {
      var d = 4; // innerå‡½æ•°ä½œç”¨åŸŸ

      // ä½œç”¨åŸŸé“¾ï¼šinner â†’ middle â†’ outer â†’ å…¨å±€
      console.log(a); // 1ï¼ˆå…¨å±€ä½œç”¨åŸŸï¼‰
      console.log(b); // 2ï¼ˆouterä½œç”¨åŸŸï¼‰
      console.log(c); // 3ï¼ˆmiddleä½œç”¨åŸŸï¼‰
      console.log(d); // 4ï¼ˆinnerä½œç”¨åŸŸï¼‰
    }

    inner();
    // console.log(d); // ReferenceErrorï¼ˆdåœ¨innerä½œç”¨åŸŸï¼‰
  }

  middle();
}

outer();
```

---

### é—­åŒ…â­â­â­â­â­

**é‡è¦æ€§ï¼šé«˜é¢‘å¿…è€ƒï¼Œå®é™…åº”ç”¨å¹¿æ³›**

#### é—­åŒ…çš„å®šä¹‰

é—­åŒ…æ˜¯æŒ‡å‡½æ•°èƒ½å¤Ÿè®¿é—®å…¶å®šä¹‰æ—¶æ‰€åœ¨ä½œç”¨åŸŸçš„å˜é‡ï¼Œå³ä½¿å‡½æ•°åœ¨å…¶ä»–åœ°æ–¹æ‰§è¡Œã€‚

**é—­åŒ…ä¸‰è¦ç´ ï¼š**
1. å‡½æ•°åµŒå¥—å‡½æ•°
2. å†…éƒ¨å‡½æ•°å¼•ç”¨å¤–éƒ¨å‡½æ•°çš„å˜é‡
3. å†…éƒ¨å‡½æ•°è¢«è¿”å›æˆ–ä¼ é€’åˆ°å¤–éƒ¨

**è®°å¿†å£è¯€ï¼š**
```
å‡½æ•°å¥—å‡½æ•°ï¼ˆåµŒå¥—å‡½æ•°ï¼‰
å†…è®¿å¤–å˜é‡ï¼ˆå¼•ç”¨å¤–éƒ¨å˜é‡ï¼‰
å¤–ä¼ å†…å‡½æ•°ï¼ˆè¿”å›å†…éƒ¨å‡½æ•°ï¼‰
```

#### é—­åŒ…çš„ä½œç”¨

1. **æ•°æ®ç§æœ‰åŒ–**ï¼šåˆ›å»ºç§æœ‰å˜é‡
2. **å»¶é•¿å˜é‡ç”Ÿå‘½å‘¨æœŸ**ï¼šå¤–éƒ¨å‡½æ•°æ‰§è¡Œå®Œï¼Œå˜é‡ä¸ä¼šè¢«é”€æ¯
3. **åˆ›å»ºå‡½æ•°å·¥å‚**ï¼šç”Ÿæˆç‰¹å®šåŠŸèƒ½çš„å‡½æ•°

#### å®Œæ•´ä»£ç ç¤ºä¾‹

**ç¤ºä¾‹1ï¼šè®¡æ•°å™¨ï¼ˆæ•°æ®ç§æœ‰åŒ–ï¼‰**
```javascript
// ä¸ä½¿ç”¨é—­åŒ…ï¼ˆæ•°æ®å¯ä»¥è¢«å¤–éƒ¨ä¿®æ”¹ï¼‰
let count = 0;
function increment() {
  count++;
  return count;
}
console.log(increment()); // 1
console.log(increment()); // 2
count = 100; // å¯ä»¥è¢«å¤–éƒ¨ä¿®æ”¹
console.log(increment()); // 101

// ä½¿ç”¨é—­åŒ…ï¼ˆæ•°æ®ç§æœ‰ï¼‰
function createCounter() {
  let count = 0; // ç§æœ‰å˜é‡

  return {
    increment: function() {
      count++;
      return count;
    },
    decrement: function() {
      count--;
      return count;
    },
    getCount: function() {
      return count;
    }
  };
}

const counter = createCounter();
console.log(counter.increment()); // 1
console.log(counter.increment()); // 2
console.log(counter.getCount()); // 2
console.log(counter.decrement()); // 1
// counter.count = 100; // æ— æ³•ç›´æ¥ä¿®æ”¹count
console.log(counter.getCount()); // 1

// æ¯ä¸ªè®¡æ•°å™¨éƒ½æœ‰ç‹¬ç«‹çš„count
const counter2 = createCounter();
console.log(counter2.increment()); // 1
console.log(counter.getCount()); // 1ï¼ˆä¸å—counter2å½±å“ï¼‰
```

**ç¤ºä¾‹2ï¼šå¾ªç¯é—®é¢˜ä¸é—­åŒ…è§£å†³æ–¹æ¡ˆ**

```javascript
// é—®é¢˜ï¼šä½¿ç”¨varçš„å¾ªç¯ï¼ˆé”™è¯¯ç¤ºä¾‹ï¼‰
for (var i = 0; i < 5; i++) {
  setTimeout(function() {
    console.log(i); // è¾“å‡º5ä¸ª5
  }, 1000);
}
// åŸå› ï¼šsetTimeoutæ˜¯å¼‚æ­¥çš„ï¼Œå¾ªç¯ç»“æŸåiå·²ç»æ˜¯5
// æ‰€æœ‰setTimeoutå…±äº«åŒä¸€ä¸ªi

// è§£å†³æ–¹æ¡ˆ1ï¼šä½¿ç”¨letï¼ˆå—çº§ä½œç”¨åŸŸï¼‰âœ… æ¨è
for (let i = 0; i < 5; i++) {
  setTimeout(function() {
    console.log(i); // è¾“å‡º0 1 2 3 4
  }, 1000);
}
// åŸå› ï¼šletåœ¨æ¯æ¬¡å¾ªç¯æ—¶éƒ½ä¼šåˆ›å»ºæ–°çš„ä½œç”¨åŸŸ

// è§£å†³æ–¹æ¡ˆ2ï¼šä½¿ç”¨é—­åŒ…ï¼ˆIIFEï¼‰
for (var i = 0; i < 5; i++) {
  (function(j) {
    setTimeout(function() {
      console.log(j); // è¾“å‡º0 1 2 3 4
    }, 1000);
  })(i);
}
// åŸå› ï¼šç«‹å³æ‰§è¡Œå‡½æ•°åˆ›å»ºäº†æ–°çš„ä½œç”¨åŸŸï¼Œjæ˜¯å‚æ•°çš„æ‹·è´

// è§£å†³æ–¹æ¡ˆ3ï¼šä½¿ç”¨é—­åŒ…ï¼ˆå‡½æ•°å·¥å‚ï¼‰
function createLogger(index) {
  return function() {
    console.log(index);
  };
}

for (var i = 0; i < 5; i++) {
  setTimeout(createLogger(i), 1000);
}
// è¾“å‡º0 1 2 3 4

// è§£å†³æ–¹æ¡ˆ4ï¼šä½¿ç”¨bind
for (var i = 0; i < 5; i++) {
  setTimeout(console.log.bind(null, i), 1000);
}
// è¾“å‡º0 1 2 3 4
```

**ç¤ºä¾‹3ï¼šå‡½æ•°å·¥å‚**
```javascript
// åˆ›å»ºä¸åŒå€æ•°çš„ä¹˜æ³•å™¨
function createMultiplier(multiplier) {
  return function(x) {
    return x * multiplier;
  };
}

const double = createMultiplier(2);
const triple = createMultiplier(3);
const quadruple = createMultiplier(4);

console.log(double(5)); // 10
console.log(triple(5)); // 15
console.log(quadruple(5)); // 20

// åˆ›å»ºä¸åŒè´§å¸çš„æ ¼å¼åŒ–å™¨
function createCurrencyFormatter(symbol) {
  return function(amount) {
    return `${symbol}${amount.toFixed(2)}`;
  };
}

const formatUSD = createCurrencyFormatter('$');
const formatEUR = createCurrencyFormatter('â‚¬');
const formatCNY = createCurrencyFormatter('Â¥');

console.log(formatUSD(99.9)); // $99.90
console.log(formatEUR(99.9)); // â‚¬99.90
console.log(formatCNY(99.9)); // Â¥99.90
```

**ç¤ºä¾‹4ï¼šæ¨¡å—æ¨¡å¼**
```javascript
const userModule = (function() {
  // ç§æœ‰å˜é‡
  let users = [];
  let currentId = 0;

  // ç§æœ‰æ–¹æ³•
  function generateId() {
    return ++currentId;
  }

  // å…¬å¼€æ¥å£
  return {
    addUser: function(name, email) {
      const user = {
        id: generateId(),
        name: name,
        email: email
      };
      users.push(user);
      return user;
    },

    getUser: function(id) {
      return users.find(user => user.id === id);
    },

    getAllUsers: function() {
      // è¿”å›å‰¯æœ¬ï¼Œé˜²æ­¢å¤–éƒ¨ä¿®æ”¹
      return users.map(user => ({...user}));
    },

    deleteUser: function(id) {
      const index = users.findIndex(user => user.id === id);
      if (index !== -1) {
        users.splice(index, 1);
        return true;
      }
      return false;
    }
  };
})();

// ä½¿ç”¨
const user1 = userModule.addUser('å¼ ä¸‰', 'zhangsan@example.com');
const user2 = userModule.addUser('æå››', 'lisi@example.com');

console.log(userModule.getAllUsers());
// [
//   { id: 1, name: 'å¼ ä¸‰', email: 'zhangsan@example.com' },
//   { id: 2, name: 'æå››', email: 'lisi@example.com' }
// ]

console.log(userModule.getUser(1));
// { id: 1, name: 'å¼ ä¸‰', email: 'zhangsan@example.com' }

userModule.deleteUser(1);
console.log(userModule.getAllUsers());
// [{ id: 2, name: 'æå››', email: 'lisi@example.com' }]

// ç§æœ‰å˜é‡å’Œæ–¹æ³•æ— æ³•è®¿é—®
// console.log(users); // ReferenceError
// console.log(generateId); // ReferenceError
```

**ç¤ºä¾‹5ï¼šç¼“å­˜å‡½æ•°ç»“æœ**
```javascript
function memoize(fn) {
  const cache = {};

  return function(...args) {
    const key = JSON.stringify(args);

    if (key in cache) {
      console.log('ä»ç¼“å­˜ä¸­è·å–');
      return cache[key];
    }

    console.log('è®¡ç®—ç»“æœ');
    const result = fn.apply(this, args);
    cache[key] = result;
    return result;
  };
}

// æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼ˆæ€§èƒ½æµ‹è¯•ï¼‰
function fibonacci(n) {
  if (n <= 1) return n;
  return fibonacci(n - 1) + fibonacci(n - 2);
}

const memoizedFibonacci = memoize(fibonacci);

console.time('ç¬¬ä¸€æ¬¡è®¡ç®—');
console.log(memoizedFibonacci(40)); // è®¡ç®—ç»“æœ 102334155
console.timeEnd('ç¬¬ä¸€æ¬¡è®¡ç®—'); // çº¦1000ms

console.time('ç¬¬äºŒæ¬¡è®¡ç®—');
console.log(memoizedFibonacci(40)); // ä»ç¼“å­˜ä¸­è·å– 102334155
console.timeEnd('ç¬¬äºŒæ¬¡è®¡ç®—'); // çº¦0ms
```

#### é—­åŒ…çš„ç¼ºç‚¹

1. **å†…å­˜æ³„æ¼é£é™©**ï¼šé—­åŒ…ä¼šä½¿å¤–éƒ¨å‡½æ•°çš„å˜é‡ä¸€ç›´ä¿å­˜åœ¨å†…å­˜ä¸­
2. **æ€§èƒ½é—®é¢˜**ï¼šä½œç”¨åŸŸé“¾å˜é•¿ï¼ŒæŸ¥æ‰¾å˜é‡æ—¶é—´å¢åŠ 

**é¿å…å†…å­˜æ³„æ¼ï¼š**
```javascript
// åŠæ—¶æ¸…ç†ä¸éœ€è¦çš„é—­åŒ…
let closure = (function() {
  let largeData = new Array(1000000).fill('data');

  return function() {
    return largeData.length;
  };
})();

// ä½¿ç”¨å®Œåæ¸…ç†
closure = null; // é‡Šæ”¾å†…å­˜
```

### è®°å¿†å£è¯€

```
ä½œç”¨åŸŸä¸‰å…„å¼Ÿï¼šå…¨å±€å‡½æ•°å—
å…¨å±€åˆ°å¤„è®¿é—®ï¼Œå‡½æ•°å†…éƒ¨ç§æœ‰ï¼Œå—çº§letå’Œconst

é—­åŒ…ä¸‰è¦ç´ ï¼šå‡½æ•°å¥—å‡½æ•°ã€å†…è®¿å¤–å˜é‡ã€å¤–ä¼ å†…å‡½æ•°
é—­åŒ…ä½œç”¨ï¼šæ•°æ®ç§æœ‰åŒ–ã€å»¶é•¿ç”Ÿå‘½å‘¨æœŸã€å‡½æ•°å·¥å‚

å¾ªç¯é—­åŒ…é—®é¢˜ï¼šletå—çº§ä½œç”¨åŸŸã€IIFEç«‹å³æ‰§è¡Œã€å‡½æ•°å·¥å‚åŒ…ä¸€å±‚
```

---

# ç¬¬å››éƒ¨åˆ†ï¼šäº‹ä»¶æœºåˆ¶è¿›é˜¶ï¼ˆå®Œæ•´è¯¦ç»†ï¼‰

## ä¸€ã€addEventListenerè¯¦è§£

### åŸºæœ¬è¯­æ³•â­â­â­â­â­

```javascript
element.addEventListener(type, listener, options);
```

**å‚æ•°è¯´æ˜ï¼š**
- **type**ï¼šäº‹ä»¶ç±»å‹ï¼ˆå¦‚'click'ã€'scroll'ã€'keydown'ï¼‰
- **listener**ï¼šäº‹ä»¶å¤„ç†å‡½æ•°
- **options**ï¼šé…ç½®å¯¹è±¡æˆ–å¸ƒå°”å€¼

### listenerå‚æ•°çš„å¤šç§å½¢å¼

**å®Œæ•´ä»£ç ç¤ºä¾‹ï¼š**
```javascript
const button = document.getElementById('btn');

// 1. å‡½æ•°å¼•ç”¨
function handleClick(e) {
  console.log('clicked', e);
}
button.addEventListener('click', handleClick);

// 2. åŒ¿åå‡½æ•°ï¼ˆthisæŒ‡å‘elementï¼‰
button.addEventListener('click', function(e) {
  console.log('clicked');
  console.log(this); // buttonå…ƒç´ 
});

// 3. ç®­å¤´å‡½æ•°ï¼ˆthisä¸æŒ‡å‘elementï¼‰
button.addEventListener('click', (e) => {
  console.log('clicked');
  console.log(this); // å¤–å±‚ä½œç”¨åŸŸçš„thisï¼ˆé€šå¸¸æ˜¯windowï¼‰
});

// 4. å¯¹è±¡å½¢å¼ï¼ˆéœ€å®ç°handleEventæ–¹æ³•ï¼‰
const handler = {
  count: 0,
  handleEvent(e) {
    this.count++;
    console.log('clicked', this.count, 'times');
    console.log(this); // handlerå¯¹è±¡
  }
};
button.addEventListener('click', handler);
```

---

### optionså‚æ•°è¯¦è§£â­â­â­â­â­

optionså¯ä»¥æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼æˆ–å¯¹è±¡ï¼š
- å¸ƒå°”å€¼ï¼šç­‰åŒäº`{ capture: true/false }`
- å¯¹è±¡ï¼šå¯ä»¥åŒ…å«captureã€onceã€passiveã€signalå››ä¸ªå±æ€§

#### 1. capture - æ§åˆ¶äº‹ä»¶é˜¶æ®µ

**è¯´æ˜ï¼š**
- `true`ï¼šæ•è·é˜¶æ®µè§¦å‘
- `false`ï¼šå†’æ³¡é˜¶æ®µè§¦å‘ï¼ˆé»˜è®¤ï¼‰

**å®Œæ•´ä»£ç ç¤ºä¾‹ï¼š**
```html
<div id="parent">
  <button id="child">ç‚¹å‡»æˆ‘</button>
</div>

<script>
const parent = document.getElementById('parent');
const child = document.getElementById('child');

// å†’æ³¡é˜¶æ®µï¼ˆé»˜è®¤ï¼‰
parent.addEventListener('click', () => {
  console.log('çˆ¶å…ƒç´  - å†’æ³¡');
}, false); // æˆ–ä¸ä¼ 

child.addEventListener('click', () => {
  console.log('å­å…ƒç´  - å†’æ³¡');
}, false);

// æ•è·é˜¶æ®µ
parent.addEventListener('click', () => {
  console.log('çˆ¶å…ƒç´  - æ•è·');
}, true);

child.addEventListener('click', () => {
  console.log('å­å…ƒç´  - æ•è·');
}, true);

// ç‚¹å‡»å­å…ƒç´ ï¼Œè¾“å‡ºé¡ºåºï¼š
// çˆ¶å…ƒç´  - æ•è·ï¼ˆæ•è·é˜¶æ®µï¼šå¤–â†’å†…ï¼‰
// å­å…ƒç´  - æ•è·
// å­å…ƒç´  - å†’æ³¡ï¼ˆç›®æ ‡é˜¶æ®µï¼‰
// çˆ¶å…ƒç´  - å†’æ³¡ï¼ˆå†’æ³¡é˜¶æ®µï¼šå†…â†’å¤–ï¼‰
</script>
```

#### 2. once - åªè§¦å‘ä¸€æ¬¡

**è¯´æ˜ï¼š**
- äº‹ä»¶è§¦å‘ä¸€æ¬¡åè‡ªåŠ¨ç§»é™¤ç›‘å¬å™¨
- ç›¸å½“äºåœ¨å›è°ƒä¸­è°ƒç”¨removeEventListener

**å®Œæ•´ä»£ç ç¤ºä¾‹ï¼š**
```javascript
const button = document.getElementById('btn');

// ä¸ä½¿ç”¨once
let clickCount = 0;
function handleClick() {
  clickCount++;
  console.log('ç‚¹å‡»æ¬¡æ•°:', clickCount);

  if (clickCount >= 1) {
    button.removeEventListener('click', handleClick);
  }
}
button.addEventListener('click', handleClick);

// ä½¿ç”¨onceï¼ˆæ›´ç®€æ´ï¼‰âœ… æ¨è
button.addEventListener('click', () => {
  console.log('åªæ‰§è¡Œä¸€æ¬¡');
}, { once: true });

// å®é™…åº”ç”¨ï¼šé¦–æ¬¡äº¤äº’æ£€æµ‹
let hasInteracted = false;
document.addEventListener('click', () => {
  if (!hasInteracted) {
    hasInteracted = true;
    console.log('ç”¨æˆ·é¦–æ¬¡ç‚¹å‡»');
    // åŠ è½½æ›´å¤šèµ„æºã€å¯åŠ¨åˆ†æç­‰
  }
}, { once: true });

// å®é™…åº”ç”¨ï¼šä¸€æ¬¡æ€§æç¤º
function showWelcome() {
  alert('æ¬¢è¿é¦–æ¬¡è®¿é—®ï¼');
}
document.addEventListener('DOMContentLoaded', showWelcome, { once: true });
```

#### 3. passive - æ€§èƒ½ä¼˜åŒ–ï¼ˆé‡è¦ï¼‰â­â­â­â­â­

**è¯´æ˜ï¼š**
- å‘Šè¯‰æµè§ˆå™¨ä¸ä¼šè°ƒç”¨`preventDefault()`
- æµè§ˆå™¨å¯ä»¥ç«‹å³æ‰§è¡Œæ»šåŠ¨ï¼Œä¸éœ€è¦ç­‰å¾…äº‹ä»¶å¤„ç†å®Œæˆ
- æ˜¾è‘—æå‡æ»šåŠ¨æ€§èƒ½ï¼Œç‰¹åˆ«æ˜¯ç§»åŠ¨ç«¯

**æ€§èƒ½é—®é¢˜åŸç†ï¼š**
```javascript
// é—®é¢˜åœºæ™¯ï¼šè§¦æ‘¸æ»šåŠ¨äº‹ä»¶
element.addEventListener('touchstart', (e) => {
  // æµè§ˆå™¨ä¸çŸ¥é“è¿™é‡Œæ˜¯å¦ä¼šè°ƒç”¨preventDefault()
  // å¿…é¡»ç­‰å¾…æ­¤å‡½æ•°æ‰§è¡Œå®Œæ‰èƒ½å†³å®šæ˜¯å¦æ»šåŠ¨
  // å¦‚æœå‡½æ•°æ‰§è¡Œæ—¶é—´é•¿ï¼Œä¼šå¯¼è‡´æ»šåŠ¨å¡é¡¿

  doSomething(); // è€—æ—¶æ“ä½œ

  // å¦‚æœæœ€åè°ƒç”¨äº†preventDefaultï¼Œæµè§ˆå™¨éœ€è¦é˜»æ­¢æ»šåŠ¨
  // e.preventDefault();
});

// é—®é¢˜ï¼šå³ä½¿ä¸è°ƒç”¨preventDefault()ï¼Œæµè§ˆå™¨ä¹Ÿè¦ç­‰å¾…ç¡®è®¤
// å¯¼è‡´æ»šåŠ¨å“åº”å»¶è¿Ÿï¼Œç”¨æˆ·ä½“éªŒå·®
```

**è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨passive**
```javascript
// âœ… ä½¿ç”¨passiveå‘Šè¯‰æµè§ˆå™¨ä¸ä¼šé˜»æ­¢é»˜è®¤è¡Œä¸º
element.addEventListener('touchstart', (e) => {
  // æµè§ˆå™¨çŸ¥é“ä¸ä¼šè°ƒç”¨preventDefault()
  // å¯ä»¥ç«‹å³å¼€å§‹æ»šåŠ¨ï¼Œä¸éœ€è¦ç­‰å¾…

  doSomething(); // è€—æ—¶æ“ä½œ

  // âš ï¸ å¦‚æœè°ƒç”¨preventDefault()ä¼šæŠ¥è­¦å‘Š
  // e.preventDefault(); // æ— æ•ˆä¸”ä¼šæœ‰è­¦å‘Š
}, { passive: true });
```

**å®Œæ•´ä»£ç ç¤ºä¾‹ï¼š**
```javascript
// ç¤ºä¾‹1ï¼šæ»šåŠ¨äº‹ä»¶æ€§èƒ½ä¼˜åŒ–
window.addEventListener('scroll', () => {
  // æ»šåŠ¨æ—¶çš„å¤„ç†é€»è¾‘
  const scrollTop = window.pageYOffset;
  console.log('æ»šåŠ¨ä½ç½®:', scrollTop);

  // æ›´æ–°UI
  updateScrollIndicator(scrollTop);
}, { passive: true });

// ç¤ºä¾‹2ï¼šè§¦æ‘¸äº‹ä»¶æ€§èƒ½ä¼˜åŒ–
const slider = document.querySelector('.slider');

slider.addEventListener('touchstart', (e) => {
  // è®°å½•è§¦æ‘¸èµ·ç‚¹
  const touch = e.touches[0];
  startX = touch.clientX;
  startY = touch.clientY;
}, { passive: true });

slider.addEventListener('touchmove', (e) => {
  // è®¡ç®—æ»‘åŠ¨è·ç¦»
  const touch = e.touches[0];
  const deltaX = touch.clientX - startX;
  const deltaY = touch.clientY - startY;

  // æ›´æ–°UI
  updateSliderPosition(deltaX);

  // âš ï¸ ä¸èƒ½è°ƒç”¨preventDefault()
  // e.preventDefault(); // ä¼šæŠ¥è­¦å‘Š
}, { passive: true });

// ç¤ºä¾‹3ï¼šéœ€è¦é˜»æ­¢é»˜è®¤è¡Œä¸ºæ—¶ï¼ˆå¿…é¡»è®¾ç½®passive: falseï¼‰
slider.addEventListener('touchstart', (e) => {
  // æŸäº›æƒ…å†µéœ€è¦é˜»æ­¢é»˜è®¤è¡Œä¸º
  if (shouldPreventDefault()) {
    e.preventDefault(); // æœ‰æ•ˆ
  }
}, { passive: false }); // æ˜¾å¼è®¾ç½®ä¸ºfalse

// ç¤ºä¾‹4ï¼šChrome 56+çš„é»˜è®¤è¡Œä¸º
// ä»¥ä¸‹äº‹ä»¶åœ¨document/body/windowä¸Šé»˜è®¤passive: true
// touchstart
// touchmove
// wheel
// mousewheel

// å¦‚æœéœ€è¦é˜»æ­¢é»˜è®¤è¡Œä¸ºï¼Œå¿…é¡»æ˜¾å¼è®¾ç½®passive: false
document.addEventListener('touchmove', (e) => {
  e.preventDefault(); // éœ€è¦è®¾ç½®passive: false
}, { passive: false });

// ç¤ºä¾‹5ï¼šç‰¹æ€§æ£€æµ‹
let passiveSupported = false;

try {
  const options = {
    get passive() {
      passiveSupported = true;
      return false;
    }
  };

  window.addEventListener('test', null, options);
  window.removeEventListener('test', null, options);
} catch (err) {
  passiveSupported = false;
}

// æ ¹æ®æ”¯æŒæƒ…å†µä½¿ç”¨
window.addEventListener('scroll', handleScroll,
  passiveSupported ? { passive: true } : false
);
```

**æ€§èƒ½å¯¹æ¯”ï¼š**
```javascript
// âŒ ä¸ä½¿ç”¨passiveï¼ˆæ€§èƒ½å·®ï¼‰
window.addEventListener('scroll', () => {
  // æµè§ˆå™¨å¿…é¡»ç­‰å¾…æ­¤å‡½æ•°æ‰§è¡Œå®Œ
  heavyCalculation(); // å‡è®¾è€—æ—¶100ms
  // æ»šåŠ¨ä¼šæœ‰100mså»¶è¿Ÿï¼Œå¡é¡¿æ˜æ˜¾
});

// âœ… ä½¿ç”¨passiveï¼ˆæ€§èƒ½å¥½ï¼‰
window.addEventListener('scroll', () => {
  // æµè§ˆå™¨å¯ä»¥ç«‹å³æ»šåŠ¨ï¼Œä¸ç­‰å¾…æ­¤å‡½æ•°
  heavyCalculation(); // å‡è®¾è€—æ—¶100ms
  // æ»šåŠ¨æµç•…ï¼Œè®¡ç®—åœ¨åå°è¿›è¡Œ
}, { passive: true });
```

#### 4. signal - æ‰¹é‡ç§»é™¤ç›‘å¬å™¨

**è¯´æ˜ï¼š**
- ä½¿ç”¨AbortControlleråˆ›å»ºä¿¡å·
- ä¸€æ¬¡æ€§ç§»é™¤å¤šä¸ªç›‘å¬å™¨
- æ¯”é€ä¸ªè°ƒç”¨removeEventListeneræ›´æ–¹ä¾¿

**å®Œæ•´ä»£ç ç¤ºä¾‹ï¼š**
```javascript
// åˆ›å»ºAbortController
const controller = new AbortController();
const signal = controller.signal;

// æ·»åŠ å¤šä¸ªç›‘å¬å™¨
document.addEventListener('click', handleClick, { signal });
document.addEventListener('keydown', handleKeydown, { signal });
document.addEventListener('scroll', handleScroll, { signal });
window.addEventListener('resize', handleResize, { signal });

// ä¸€æ¬¡æ€§ç§»é™¤æ‰€æœ‰ç›‘å¬å™¨
controller.abort();

// å®é™…åº”ç”¨1ï¼šç»„ä»¶å¸è½½æ—¶æ¸…ç†
class Component {
  constructor() {
    this.controller = new AbortController();
    this.signal = this.controller.signal;
  }

  mount() {
    // æ·»åŠ å¤šä¸ªäº‹ä»¶ç›‘å¬
    document.addEventListener('click', this.handleClick, {
      signal: this.signal
    });
    document.addEventListener('keydown', this.handleKeydown, {
      signal: this.signal
    });
    window.addEventListener('resize', this.handleResize, {
      signal: this.signal
    });
  }

  unmount() {
    // ä¸€æ¬¡æ€§æ¸…ç†æ‰€æœ‰ç›‘å¬å™¨
    this.controller.abort();
  }

  handleClick = () => { /* ... */ }
  handleKeydown = () => { /* ... */ }
  handleResize = () => { /* ... */ }
}

// ä½¿ç”¨
const component = new Component();
component.mount();
// ... ä½¿ç”¨ä¸€æ®µæ—¶é—´å
component.unmount(); // æ¸…ç†æ‰€æœ‰ç›‘å¬å™¨

// å®é™…åº”ç”¨2ï¼šæ¡ä»¶æ€§ç§»é™¤
const modalController = new AbortController();

function openModal() {
  // æ‰“å¼€æ¨¡æ€æ¡†æ—¶æ·»åŠ ç›‘å¬
  document.addEventListener('keydown', handleEscape, {
    signal: modalController.signal
  });
  document.addEventListener('click', handleOutsideClick, {
    signal: modalController.signal
  });
}

function closeModal() {
  // å…³é—­æ¨¡æ€æ¡†æ—¶ç§»é™¤ç›‘å¬
  modalController.abort();
}

// å®é™…åº”ç”¨3ï¼šè¶…æ—¶è‡ªåŠ¨ç§»é™¤
const timeoutController = new AbortController();

button.addEventListener('click', handleClick, {
  signal: timeoutController.signal
});

// 5ç§’åè‡ªåŠ¨ç§»é™¤
setTimeout(() => {
  timeoutController.abort();
  console.log('5ç§’åè‡ªåŠ¨ç§»é™¤ç›‘å¬å™¨');
}, 5000);
```

### ç»„åˆä½¿ç”¨ï¼ˆå®æˆ˜ç¤ºä¾‹ï¼‰â­â­â­â­â­

```javascript
// å®æˆ˜1ï¼šé¦–æ¬¡äº¤äº’æ£€æµ‹ï¼ˆonce + capture + passiveï¼‰
const controller = new AbortController();

['click', 'keydown', 'scroll', 'touchstart'].forEach(type => {
  document.addEventListener(type, () => {
    console.log('é¦–æ¬¡ç”¨æˆ·äº¤äº’');

    // åŠ è½½æ¬¡è¦èµ„æº
    loadSecondaryResources();

    // å¯åŠ¨åˆ†æ
    initAnalytics();

    // ç§»é™¤æ‰€æœ‰ç›‘å¬å™¨
    controller.abort();
  }, {
    once: true,          // åªè§¦å‘ä¸€æ¬¡
    capture: true,       // æ•è·é˜¶æ®µï¼ˆæ›´æ—©è§¦å‘ï¼‰
    passive: true,       // æ€§èƒ½ä¼˜åŒ–
    signal: controller.signal  // ä¾¿äºç»Ÿä¸€ç®¡ç†
  });
});

// å®æˆ˜2ï¼šæ¨¡æ€æ¡†å¤–éƒ¨ç‚¹å‡»å…³é—­
function createModal() {
  const modal = document.querySelector('.modal');
  const controller = new AbortController();

  function open() {
    modal.classList.add('show');

    // æ·»åŠ å¤–éƒ¨ç‚¹å‡»ç›‘å¬
    document.addEventListener('click', (e) => {
      if (!modal.contains(e.target)) {
        close();
      }
    }, {
      capture: true,  // æ•è·é˜¶æ®µï¼Œå…ˆäºå†…éƒ¨äº‹ä»¶
      signal: controller.signal
    });

    // ESCé”®å…³é—­
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        close();
      }
    }, {
      once: true,  // åªå…³é—­ä¸€æ¬¡
      signal: controller.signal
    });
  }

  function close() {
    modal.classList.remove('show');
    controller.abort(); // ç§»é™¤æ‰€æœ‰ç›‘å¬å™¨
  }

  return { open, close };
}

// å®æˆ˜3ï¼šæ»šåŠ¨åˆ°åº•éƒ¨åŠ è½½æ›´å¤šï¼ˆpassive + signalï¼‰
class InfiniteScroll {
  constructor(container) {
    this.container = container;
    this.controller = new AbortController();
    this.loading = false;
  }

  start() {
    window.addEventListener('scroll', () => {
      if (this.loading) return;

      const { scrollTop, scrollHeight, clientHeight } = document.documentElement;

      // è·ç¦»åº•éƒ¨100pxæ—¶åŠ è½½
      if (scrollTop + clientHeight >= scrollHeight - 100) {
        this.loadMore();
      }
    }, {
      passive: true,  // æ€§èƒ½ä¼˜åŒ–
      signal: this.controller.signal
    });
  }

  async loadMore() {
    this.loading = true;

    // åŠ è½½æ•°æ®
    const data = await fetchData();
    this.container.append(...data);

    this.loading = false;
  }

  stop() {
    this.controller.abort();
  }
}

// å®æˆ˜4ï¼šé˜²æŠ–æ»šåŠ¨äº‹ä»¶ï¼ˆpassiveï¼‰
let scrollTimer = null;

window.addEventListener('scroll', () => {
  // æ»šåŠ¨æ—¶éšè—header
  document.body.classList.add('scrolling');

  // æ¸…é™¤ä¹‹å‰çš„å®šæ—¶å™¨
  clearTimeout(scrollTimer);

  // 500msåæ˜¾ç¤ºheader
  scrollTimer = setTimeout(() => {
    document.body.classList.remove('scrolling');
  }, 500);
}, { passive: true }); // æ€§èƒ½ä¼˜åŒ–
```

### è®°å¿†å£è¯€

```
addEventListenerå››å‚æ•°ï¼šcaptureã€onceã€passiveã€signal
captureæ§åˆ¶é˜¶æ®µï¼ˆtrueæ•è·falseå†’æ³¡ï¼‰
onceåªè§¦å‘ä¸€æ¬¡ï¼ˆè‡ªåŠ¨ç§»é™¤ï¼‰
passiveæ€§èƒ½ä¼˜åŒ–ï¼ˆæ»šåŠ¨è§¦æ‘¸å¿…é¡»åŠ ï¼‰
signalæ‰¹é‡ç§»é™¤ï¼ˆAbortControllerï¼‰

ç»„åˆä½¿ç”¨æœ€å¼ºå¤§ï¼š
onceæ•è·æ£€æµ‹é¦–æ¬¡äº¤äº’
passiveä¼˜åŒ–æ»šåŠ¨æ€§èƒ½
signalç»Ÿä¸€ç®¡ç†æ¸…ç†
```

---

## äºŒã€é˜²æŠ–å’ŒèŠ‚æµ

### é˜²æŠ–ï¼ˆDebounceï¼‰â­â­â­â­â­

**æ¦‚å¿µï¼š**
åœ¨äº‹ä»¶è¢«è§¦å‘nç§’åå†æ‰§è¡Œå›è°ƒï¼Œå¦‚æœåœ¨è¿™nç§’å†…åˆè¢«è§¦å‘ï¼Œåˆ™é‡æ–°è®¡æ—¶ã€‚

**æ ¸å¿ƒæ€æƒ³ï¼š**
ç­‰å¾…ç”¨æˆ·åœæ­¢æ“ä½œä¸€æ®µæ—¶é—´åæ‰æ‰§è¡Œã€‚

**åº”ç”¨åœºæ™¯ï¼š**
1. æœç´¢æ¡†è¾“å…¥ï¼šç”¨æˆ·åœæ­¢è¾“å…¥åå†æœç´¢
2. çª—å£resizeï¼šçª—å£è°ƒæ•´å®Œæˆåå†è®¡ç®—å¸ƒå±€
3. è¡¨å•éªŒè¯ï¼šç”¨æˆ·è¾“å…¥å®Œæˆåå†éªŒè¯
4. æŒ‰é’®æäº¤ï¼šé˜²æ­¢é‡å¤æäº¤

**å®Œæ•´å®ç°ä»£ç ï¼š**
```javascript
/**
 * é˜²æŠ–å‡½æ•°
 * @param {Function} fn - è¦æ‰§è¡Œçš„å‡½æ•°
 * @param {number} delay - å»¶è¿Ÿæ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
 * @param {boolean} immediate - æ˜¯å¦ç«‹å³æ‰§è¡Œ
 * @returns {Function} é˜²æŠ–åçš„å‡½æ•°
 */
function debounce(fn, delay = 300, immediate = false) {
  let timer = null;

  return function(...args) {
    // æ¸…é™¤ä¹‹å‰çš„å®šæ—¶å™¨
    if (timer) {
      clearTimeout(timer);
    }

    if (immediate) {
      // ç«‹å³æ‰§è¡Œæ¨¡å¼
      const callNow = !timer;
      timer = setTimeout(() => {
        timer = null;
      }, delay);

      if (callNow) {
        fn.apply(this, args);
      }
    } else {
      // å»¶è¿Ÿæ‰§è¡Œæ¨¡å¼
      timer = setTimeout(() => {
        fn.apply(this, args);
      }, delay);
    }
  };
}

// ä½¿ç”¨ç¤ºä¾‹1ï¼šæœç´¢æ¡†
const searchInput = document.getElementById('search');

function handleSearch(value) {
  console.log('æœç´¢:', value);
  // å‘é€æœç´¢è¯·æ±‚
  fetch(`/api/search?q=${value}`)
    .then(res => res.json())
    .then(data => {
      // æ˜¾ç¤ºæœç´¢ç»“æœ
      console.log('æœç´¢ç»“æœ:', data);
    });
}

// ä¸ä½¿ç”¨é˜²æŠ–ï¼šæ¯æ¬¡è¾“å…¥éƒ½ä¼šå‘é€è¯·æ±‚ï¼ˆæ€§èƒ½æµªè´¹ï¼‰
// searchInput.addEventListener('input', (e) => {
//   handleSearch(e.target.value);
// });

// ä½¿ç”¨é˜²æŠ–ï¼šåœæ­¢è¾“å…¥500msåæ‰å‘é€è¯·æ±‚ âœ…
const debouncedSearch = debounce(handleSearch, 500);
searchInput.addEventListener('input', (e) => {
  debouncedSearch(e.target.value);
});

// ä½¿ç”¨ç¤ºä¾‹2ï¼šçª—å£resize
function handleResize() {
  console.log('çª—å£å¤§å°:', window.innerWidth, window.innerHeight);
  // é‡æ–°è®¡ç®—å¸ƒå±€
  recalculateLayout();
}

// ä¸ä½¿ç”¨é˜²æŠ–ï¼šresizeæ—¶ä¼šè§¦å‘å‡ ç™¾æ¬¡ï¼ˆæ€§èƒ½é—®é¢˜ï¼‰
// window.addEventListener('resize', handleResize);

// ä½¿ç”¨é˜²æŠ–ï¼šè°ƒæ•´å®Œæˆå300msæ‰æ‰§è¡Œ âœ…
const debouncedResize = debounce(handleResize, 300);
window.addEventListener('resize', debouncedResize);

// ä½¿ç”¨ç¤ºä¾‹3ï¼šè¡¨å•éªŒè¯
const usernameInput = document.getElementById('username');

function validateUsername(username) {
  console.log('éªŒè¯ç”¨æˆ·å:', username);
  // å‘é€éªŒè¯è¯·æ±‚
  return fetch(`/api/validate-username?username=${username}`)
    .then(res => res.json());
}

const debouncedValidate = debounce(async function(e) {
  const username = e.target.value;

  if (username.length < 3) {
    showError('ç”¨æˆ·åè‡³å°‘3ä¸ªå­—ç¬¦');
    return;
  }

  const result = await validateUsername(username);

  if (result.valid) {
    showSuccess('ç”¨æˆ·åå¯ç”¨');
  } else {
    showError('ç”¨æˆ·åå·²å­˜åœ¨');
  }
}, 500);

usernameInput.addEventListener('input', debouncedValidate);

// ä½¿ç”¨ç¤ºä¾‹4ï¼šæŒ‰é’®é˜²æ­¢é‡å¤ç‚¹å‡»ï¼ˆç«‹å³æ‰§è¡Œæ¨¡å¼ï¼‰
const submitButton = document.getElementById('submit');

function handleSubmit() {
  console.log('æäº¤è¡¨å•');
  // æäº¤è¡¨å•é€»è¾‘
  submitForm();
}

// ä½¿ç”¨ç«‹å³æ‰§è¡Œæ¨¡å¼ï¼šç¬¬ä¸€æ¬¡ç‚¹å‡»ç«‹å³æ‰§è¡Œï¼Œä¹‹å2ç§’å†…çš„ç‚¹å‡»è¢«å¿½ç•¥ âœ…
const debouncedSubmit = debounce(handleSubmit, 2000, true);
submitButton.addEventListener('click', debouncedSubmit);
```

### èŠ‚æµï¼ˆThrottleï¼‰â­â­â­â­â­

**æ¦‚å¿µï¼š**
è§„å®šåœ¨ä¸€ä¸ªå•ä½æ—¶é—´å†…ï¼Œåªèƒ½è§¦å‘ä¸€æ¬¡å‡½æ•°ã€‚å¦‚æœè¿™ä¸ªå•ä½æ—¶é—´å†…è§¦å‘å¤šæ¬¡å‡½æ•°ï¼Œåªæœ‰ä¸€æ¬¡ç”Ÿæ•ˆã€‚

**æ ¸å¿ƒæ€æƒ³ï¼š**
å›ºå®šæ—¶é—´é—´éš”æ‰§è¡Œï¼Œé™ä½æ‰§è¡Œé¢‘ç‡ã€‚

**åº”ç”¨åœºæ™¯ï¼š**
1. æ»šåŠ¨äº‹ä»¶ï¼šç›‘å¬æ»šåŠ¨ä½ç½®
2. é¼ æ ‡ç§»åŠ¨ï¼šå®æ—¶è·Ÿè¸ªé¼ æ ‡ä½ç½®
3. è§†é¢‘æ’­æ”¾è¿›åº¦ï¼šå®æ—¶æ›´æ–°è¿›åº¦
4. æ‹–æ‹½ï¼šå®æ—¶æ›´æ–°ä½ç½®

**å®Œæ•´å®ç°ä»£ç ï¼š**
```javascript
/**
 * èŠ‚æµå‡½æ•°ï¼ˆæ—¶é—´æˆ³ç‰ˆæœ¬ï¼‰
 * @param {Function} fn - è¦æ‰§è¡Œçš„å‡½æ•°
 * @param {number} delay - é—´éš”æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
 * @returns {Function} èŠ‚æµåçš„å‡½æ•°
 */
function throttle(fn, delay = 300) {
  let lastTime = 0;

  return function(...args) {
    const now = Date.now();

    if (now - lastTime >= delay) {
      fn.apply(this, args);
      lastTime = now;
    }
  };
}

/**
 * èŠ‚æµå‡½æ•°ï¼ˆå®šæ—¶å™¨ç‰ˆæœ¬ï¼‰
 * @param {Function} fn - è¦æ‰§è¡Œçš„å‡½æ•°
 * @param {number} delay - é—´éš”æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
 * @returns {Function} èŠ‚æµåçš„å‡½æ•°
 */
function throttleTimer(fn, delay = 300) {
  let timer = null;

  return function(...args) {
    if (timer) return;

    timer = setTimeout(() => {
      fn.apply(this, args);
      timer = null;
    }, delay);
  };
}

/**
 * èŠ‚æµå‡½æ•°ï¼ˆæ—¶é—´æˆ³+å®šæ—¶å™¨ç‰ˆæœ¬ï¼Œæœ€å®Œæ•´ï¼‰
 * @param {Function} fn - è¦æ‰§è¡Œçš„å‡½æ•°
 * @param {number} delay - é—´éš”æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
 * @param {Object} options - é…ç½®é¡¹
 * @param {boolean} options.leading - æ˜¯å¦åœ¨å¼€å§‹æ—¶æ‰§è¡Œ
 * @param {boolean} options.trailing - æ˜¯å¦åœ¨ç»“æŸæ—¶æ‰§è¡Œ
 * @returns {Function} èŠ‚æµåçš„å‡½æ•°
 */
function throttleComplete(fn, delay = 300, options = {}) {
  let timer = null;
  let lastTime = 0;
  const { leading = true, trailing = true } = options;

  return function(...args) {
    const now = Date.now();

    if (!lastTime && !leading) {
      lastTime = now;
    }

    const remaining = delay - (now - lastTime);

    if (remaining <= 0 || remaining > delay) {
      if (timer) {
        clearTimeout(timer);
        timer = null;
      }

      lastTime = now;
      fn.apply(this, args);
    } else if (!timer && trailing) {
      timer = setTimeout(() => {
        lastTime = leading ? Date.now() : 0;
        timer = null;
        fn.apply(this, args);
      }, remaining);
    }
  };
}

// ä½¿ç”¨ç¤ºä¾‹1ï¼šæ»šåŠ¨äº‹ä»¶
function handleScroll() {
  const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
  console.log('æ»šåŠ¨ä½ç½®:', scrollTop);

  // æ›´æ–°æ»šåŠ¨æŒ‡ç¤ºå™¨
  const scrollPercent = (scrollTop / (document.documentElement.scrollHeight - window.innerHeight)) * 100;
  document.querySelector('.scroll-indicator').style.width = scrollPercent + '%';
}

// ä¸ä½¿ç”¨èŠ‚æµï¼šæ»šåŠ¨æ—¶ä¼šè§¦å‘å‡ ç™¾æ¬¡ï¼ˆæ€§èƒ½é—®é¢˜ï¼‰
// window.addEventListener('scroll', handleScroll);

// ä½¿ç”¨èŠ‚æµï¼šæ¯100msæœ€å¤šæ‰§è¡Œä¸€æ¬¡ âœ…
const throttledScroll = throttle(handleScroll, 100);
window.addEventListener('scroll', throttledScroll);

// ä½¿ç”¨ç¤ºä¾‹2ï¼šé¼ æ ‡ç§»åŠ¨
function handleMouseMove(e) {
  console.log('é¼ æ ‡ä½ç½®:', e.clientX, e.clientY);

  // æ›´æ–°è·Ÿéšå…ƒç´ ä½ç½®
  const follower = document.querySelector('.mouse-follower');
  follower.style.left = e.clientX + 'px';
  follower.style.top = e.clientY + 'px';
}

const throttledMouseMove = throttle(handleMouseMove, 50);
document.addEventListener('mousemove', throttledMouseMove);

// ä½¿ç”¨ç¤ºä¾‹3ï¼šè§†é¢‘æ’­æ”¾è¿›åº¦
const video = document.getElementById('video');

function updateProgress() {
  const percent = (video.currentTime / video.duration) * 100;
  console.log('æ’­æ”¾è¿›åº¦:', percent + '%');

  // æ›´æ–°è¿›åº¦æ¡
  document.querySelector('.progress-bar').style.width = percent + '%';

  // ä¿å­˜è¿›åº¦åˆ°æœåŠ¡å™¨
  saveProgress(video.currentTime);
}

const throttledUpdateProgress = throttle(updateProgress, 1000);
video.addEventListener('timeupdate', throttledUpdateProgress);

// ä½¿ç”¨ç¤ºä¾‹4ï¼šè¾“å…¥æ¡†å®æ—¶æœç´¢ï¼ˆèŠ‚æµ+é˜²æŠ–ç»“åˆï¼‰
const realtimeSearchInput = document.getElementById('realtime-search');

// èŠ‚æµï¼šä¿è¯å®æ—¶æ€§ï¼ˆæœ€å¤šæ¯300msæœç´¢ä¸€æ¬¡ï¼‰
// é˜²æŠ–ï¼šé¿å…é¢‘ç¹è¯·æ±‚ï¼ˆåœæ­¢è¾“å…¥500msåæœ€åæœç´¢ä¸€æ¬¡ï¼‰
const throttledSearch = throttle(handleSearch, 300);
const debouncedSearch = debounce(handleSearch, 500);

realtimeSearchInput.addEventListener('input', (e) => {
  const value = e.target.value;
  throttledSearch(value); // å®æ—¶æœç´¢
  debouncedSearch(value); // æœ€ç»ˆæœç´¢
});

// ä½¿ç”¨ç¤ºä¾‹5ï¼šæ— é™æ»šåŠ¨åŠ è½½
let isLoading = false;

function loadMore() {
  if (isLoading) return;

  isLoading = true;
  console.log('åŠ è½½æ›´å¤š...');

  // æ¨¡æ‹ŸåŠ è½½æ•°æ®
  fetch('/api/load-more')
    .then(res => res.json())
    .then(data => {
      // æ¸²æŸ“æ•°æ®
      renderData(data);
      isLoading = false;
    });
}

function checkScrollBottom() {
  const { scrollTop, scrollHeight, clientHeight } = document.documentElement;

  // è·ç¦»åº•éƒ¨200pxæ—¶åŠ è½½
  if (scrollTop + clientHeight >= scrollHeight - 200) {
    loadMore();
  }
}

const throttledCheckScroll = throttle(checkScrollBottom, 200);
window.addEventListener('scroll', throttledCheckScroll);
```

### é˜²æŠ–å’ŒèŠ‚æµå¯¹æ¯”

| ç‰¹æ€§ | é˜²æŠ–ï¼ˆDebounceï¼‰ | èŠ‚æµï¼ˆThrottleï¼‰ |
|------|-----------------|----------------|
| **æ‰§è¡Œæ—¶æœº** | åœæ­¢è§¦å‘nç§’åæ‰§è¡Œ | å›ºå®šæ—¶é—´é—´éš”æ‰§è¡Œ |
| **æ‰§è¡Œæ¬¡æ•°** | å¤šæ¬¡è§¦å‘åªæ‰§è¡Œä¸€æ¬¡ | å›ºå®šé¢‘ç‡æ‰§è¡Œ |
| **åº”ç”¨åœºæ™¯** | æœç´¢æ¡†ã€resizeã€è¡¨å•éªŒè¯ | æ»šåŠ¨ã€é¼ æ ‡ç§»åŠ¨ã€è§†é¢‘è¿›åº¦ |
| **å“åº”é€Ÿåº¦** | è¾ƒæ…¢ï¼ˆç­‰å¾…åœæ­¢ï¼‰ | è¾ƒå¿«ï¼ˆå›ºå®šé—´éš”ï¼‰ |
| **æ ¸å¿ƒæ€æƒ³** | ç­‰å¾…ç”¨æˆ·åœæ­¢æ“ä½œ | é™ä½æ‰§è¡Œé¢‘ç‡ |

**å½¢è±¡æ¯”å–»ï¼š**
```
é˜²æŠ–ï¼šç”µæ¢¯ç­‰å¾…
- æœ‰äººæŒ‰ç”µæ¢¯ï¼Œç­‰å¾…10ç§’
- 10ç§’å†…åˆæœ‰äººæŒ‰ï¼Œé‡æ–°ç­‰å¾…10ç§’
- ç›´åˆ°10ç§’å†…æ²¡äººæŒ‰ï¼Œç”µæ¢¯æ‰å‡ºå‘

èŠ‚æµï¼šæ¸¸æˆæŠ€èƒ½å†·å´
- æŠ€èƒ½é‡Šæ”¾åè¿›å…¥å†·å´æ—¶é—´
- å†·å´æœŸé—´æ— æ³•å†æ¬¡é‡Šæ”¾
- å†·å´ç»“æŸåæ‰èƒ½é‡Šæ”¾ä¸‹ä¸€æ¬¡
```

### è®°å¿†å£è¯€

```
é˜²æŠ–ï¼šç­‰åœæ­¢ã€é‡è®¡æ—¶ã€æœ€åä¸€æ¬¡æ‰æ‰§è¡Œ
èŠ‚æµï¼šå›ºå®šé¢‘ç‡ã€æœ‰è§„å¾‹ã€é™ä½æ‰§è¡Œæ¬¡æ•°

é˜²æŠ–åœºæ™¯ï¼šæœç´¢æ¡†è¾“å…¥ã€çª—å£resizeã€è¡¨å•éªŒè¯ã€æŒ‰é’®æäº¤
èŠ‚æµåœºæ™¯ï¼šæ»šåŠ¨ç›‘å¬ã€é¼ æ ‡ç§»åŠ¨ã€è§†é¢‘è¿›åº¦ã€æ‹–æ‹½æ“ä½œ

é˜²æŠ–åƒç”µæ¢¯ï¼ˆç­‰äººé½äº†å†èµ°ï¼‰
èŠ‚æµåƒçº¢ç»¿ç¯ï¼ˆå›ºå®šé—´éš”æ”¾è¡Œï¼‰
```

---

# æ‰‹å†™ä»£ç ç»ƒä¹ 

## 1. æ‰‹å†™é˜²æŠ–å‡½æ•°

```javascript
/**
 * é˜²æŠ–å‡½æ•°
 * @param {Function} fn - è¦æ‰§è¡Œçš„å‡½æ•°
 * @param {number} delay - å»¶è¿Ÿæ—¶é—´
 * @param {boolean} immediate - æ˜¯å¦ç«‹å³æ‰§è¡Œ
 */
function debounce(fn, delay = 300, immediate = false) {
  let timer = null;

  return function(...args) {
    if (timer) {
      clearTimeout(timer);
    }

    if (immediate) {
      const callNow = !timer;
      timer = setTimeout(() => {
        timer = null;
      }, delay);

      if (callNow) {
        fn.apply(this, args);
      }
    } else {
      timer = setTimeout(() => {
        fn.apply(this, args);
      }, delay);
    }
  };
}

// æµ‹è¯•
const log = debounce((msg) => {
  console.log('æ‰§è¡Œ:', msg);
}, 1000);

log('1'); // ä¸æ‰§è¡Œ
log('2'); // ä¸æ‰§è¡Œ
log('3'); // 1ç§’åæ‰§è¡Œï¼Œè¾“å‡º'æ‰§è¡Œ: 3'
```

## 2. æ‰‹å†™èŠ‚æµå‡½æ•°

```javascript
/**
 * èŠ‚æµå‡½æ•°
 * @param {Function} fn - è¦æ‰§è¡Œçš„å‡½æ•°
 * @param {number} delay - é—´éš”æ—¶é—´
 */
function throttle(fn, delay = 300) {
  let lastTime = 0;

  return function(...args) {
    const now = Date.now();

    if (now - lastTime >= delay) {
      fn.apply(this, args);
      lastTime = now;
    }
  };
}

// æµ‹è¯•
const log = throttle((msg) => {
  console.log('æ‰§è¡Œ:', msg);
}, 1000);

log('1'); // ç«‹å³æ‰§è¡Œï¼Œè¾“å‡º'æ‰§è¡Œ: 1'
log('2'); // ä¸æ‰§è¡Œ
log('3'); // ä¸æ‰§è¡Œ
setTimeout(() => log('4'), 1500); // 1.5ç§’åæ‰§è¡Œï¼Œè¾“å‡º'æ‰§è¡Œ: 4'
```

## 3. æ‰‹å†™é—­åŒ…è®¡æ•°å™¨

```javascript
/**
 * åˆ›å»ºè®¡æ•°å™¨ï¼ˆé—­åŒ…å®ç°ï¼‰
 */
function createCounter() {
  let count = 0; // ç§æœ‰å˜é‡

  return {
    increment() {
      count++;
      return count;
    },
    decrement() {
      count--;
      return count;
    },
    getCount() {
      return count;
    },
    reset() {
      count = 0;
      return count;
    }
  };
}

// æµ‹è¯•
const counter = createCounter();
console.log(counter.increment()); // 1
console.log(counter.increment()); // 2
console.log(counter.getCount()); // 2
console.log(counter.decrement()); // 1
console.log(counter.reset()); // 0

// æ¯ä¸ªè®¡æ•°å™¨éƒ½æ˜¯ç‹¬ç«‹çš„
const counter2 = createCounter();
console.log(counter2.increment()); // 1
console.log(counter.getCount()); // 0ï¼ˆä¸å—counter2å½±å“ï¼‰
```

---

# ä»Šæ—¥ç»ƒä¹ é¢˜

## CSSéƒ¨åˆ†

### é¢˜ç›®1ï¼šdisplayä¸‰å¤§å€¼çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ
**ç­”æ¡ˆï¼š**
- **inline**ï¼šä¸ç‹¬å ä¸€è¡Œï¼Œä¸èƒ½è®¾ç½®å®½é«˜ï¼Œåªèƒ½è®¾ç½®æ°´å¹³æ–¹å‘çš„marginå’Œpadding
- **block**ï¼šç‹¬å ä¸€è¡Œï¼Œå¯ä»¥è®¾ç½®å®½é«˜ï¼Œå¯ä»¥è®¾ç½®æ‰€æœ‰æ–¹å‘çš„marginå’Œpadding
- **inline-block**ï¼šä¸ç‹¬å ä¸€è¡Œï¼Œå¯ä»¥è®¾ç½®å®½é«˜ï¼Œå¯ä»¥è®¾ç½®æ‰€æœ‰æ–¹å‘çš„marginå’Œpadding

### é¢˜ç›®2ï¼šdisplay:noneã€visibility:hiddenã€opacity:0çš„åŒºåˆ«ï¼Ÿ
**ç­”æ¡ˆï¼š**
- **display:none**ï¼šä¸å æ®ç©ºé—´ï¼Œä¸å¯äº¤äº’ï¼Œè§¦å‘é‡æ’+é‡ç»˜
- **visibility:hidden**ï¼šå æ®ç©ºé—´ï¼Œä¸å¯äº¤äº’ï¼Œä»…è§¦å‘é‡ç»˜
- **opacity:0**ï¼šå æ®ç©ºé—´ï¼Œå¯äº¤äº’ï¼Œå¯èƒ½è§¦å‘GPUåˆæˆ

---

## Vueéƒ¨åˆ†

### é¢˜ç›®1ï¼šVue3ç»„ä»¶å¦‚ä½•å®ç°çˆ¶å­é€šä¿¡ï¼Ÿè¯·å†™å‡ºå®Œæ•´ä»£ç ã€‚
**ç­”æ¡ˆï¼š**
```vue
<!-- çˆ¶ç»„ä»¶ -->
<template>
  <Child :message="msg" @update="handleUpdate" />
</template>

<script setup>
import { ref } from 'vue';
import Child from './Child.vue';

const msg = ref('Hello');

const handleUpdate = (data) => {
  console.log('æ”¶åˆ°å­ç»„ä»¶æ•°æ®:', data);
};
</script>

<!-- å­ç»„ä»¶ -->
<template>
  <div>
    <p>{{ message }}</p>
    <button @click="sendToParent">å‘é€</button>
  </div>
</template>

<script setup>
const props = defineProps({
  message: String
});

const emit = defineEmits(['update']);

const sendToParent = () => {
  emit('update', 'data from child');
};
</script>
```

### é¢˜ç›®2ï¼šVueç”Ÿå‘½å‘¨æœŸä¸­ï¼Œå“ªä¸ªé˜¶æ®µé€‚åˆæ“ä½œDOMï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ
**ç­”æ¡ˆï¼š**
- **mountedï¼ˆVue2ï¼‰/ onMountedï¼ˆVue3ï¼‰**
- **åŸå› **ï¼šæ­¤æ—¶ç»„ä»¶å·²ç»æŒ‚è½½åˆ°DOMï¼Œå¯ä»¥è®¿é—®çœŸå®DOMå…ƒç´ å’Œ$refs
- **ç”¨é€”**ï¼šDOMæ“ä½œã€ç¬¬ä¸‰æ–¹åº“åˆå§‹åŒ–ã€è·å–å…ƒç´ å°ºå¯¸ç­‰

---

## JavaScriptéƒ¨åˆ†

### é¢˜ç›®1ï¼šè§£é‡Šthisçš„äº”ç§ç»‘å®šè§„åˆ™ï¼Œå¹¶ä¸¾ä¾‹è¯´æ˜ä¼˜å…ˆçº§ã€‚
**ç­”æ¡ˆï¼š**
1. **é»˜è®¤ç»‘å®š**ï¼šç‹¬ç«‹å‡½æ•°è°ƒç”¨ï¼ŒthisæŒ‡å‘windowï¼ˆéä¸¥æ ¼ï¼‰æˆ–undefinedï¼ˆä¸¥æ ¼ï¼‰
2. **éšå¼ç»‘å®š**ï¼šå¯¹è±¡æ–¹æ³•è°ƒç”¨ï¼ŒthisæŒ‡å‘è°ƒç”¨å¯¹è±¡
3. **æ˜¾å¼ç»‘å®š**ï¼šcall/apply/bindï¼ŒthisæŒ‡å‘æŒ‡å®šå¯¹è±¡
4. **newç»‘å®š**ï¼šæ„é€ å‡½æ•°è°ƒç”¨ï¼ŒthisæŒ‡å‘æ–°å®ä¾‹
5. **ç®­å¤´å‡½æ•°**ï¼šç»§æ‰¿å¤–å±‚ä½œç”¨åŸŸçš„this

**ä¼˜å…ˆçº§ï¼šnew > æ˜¾å¼ç»‘å®š > éšå¼ç»‘å®š > é»˜è®¤ç»‘å®š**

### é¢˜ç›®2ï¼šä»€ä¹ˆæ˜¯é—­åŒ…ï¼Ÿè¯·æ‰‹å†™ä¸€ä¸ªé—­åŒ…è®¡æ•°å™¨ã€‚
**ç­”æ¡ˆï¼š**
é—­åŒ…æ˜¯æŒ‡å‡½æ•°èƒ½å¤Ÿè®¿é—®å…¶å®šä¹‰æ—¶æ‰€åœ¨ä½œç”¨åŸŸçš„å˜é‡ï¼Œå³ä½¿å‡½æ•°åœ¨å…¶ä»–åœ°æ–¹æ‰§è¡Œã€‚

```javascript
function createCounter() {
  let count = 0;

  return {
    increment() {
      count++;
      return count;
    },
    decrement() {
      count--;
      return count;
    },
    getCount() {
      return count;
    }
  };
}

const counter = createCounter();
console.log(counter.increment()); // 1
console.log(counter.increment()); // 2
console.log(counter.getCount()); // 2
```

---

## äº‹ä»¶æœºåˆ¶éƒ¨åˆ†

### é¢˜ç›®1ï¼šaddEventListenerçš„passiveé€‰é¡¹æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿä¸ºä»€ä¹ˆèƒ½æå‡æ€§èƒ½ï¼Ÿ
**ç­”æ¡ˆï¼š**
- **ä½œç”¨**ï¼šå‘Šè¯‰æµè§ˆå™¨ä¸ä¼šè°ƒç”¨preventDefault()ï¼Œæµè§ˆå™¨å¯ä»¥ç«‹å³æ‰§è¡Œæ»šåŠ¨ï¼Œä¸éœ€è¦ç­‰å¾…äº‹ä»¶å¤„ç†å®Œæˆ
- **åŸç†**ï¼šæµè§ˆå™¨é€šå¸¸éœ€è¦ç­‰å¾…äº‹ä»¶å¤„ç†å‡½æ•°æ‰§è¡Œå®Œæ‰èƒ½ç¡®è®¤æ˜¯å¦éœ€è¦é˜»æ­¢é»˜è®¤è¡Œä¸ºï¼Œå¦‚æœè®¾ç½®passive: trueï¼Œæµè§ˆå™¨çŸ¥é“ä¸ä¼šé˜»æ­¢ï¼Œå¯ä»¥ç«‹å³æ»šåŠ¨
- **åº”ç”¨**ï¼šæ»šåŠ¨ã€è§¦æ‘¸ç­‰é«˜é¢‘äº‹ä»¶ï¼Œèƒ½æ˜¾è‘—æå‡ç§»åŠ¨ç«¯æ»šåŠ¨æ€§èƒ½

### é¢˜ç›®2ï¼šæ‰‹å†™ä¸€ä¸ªé˜²æŠ–å‡½æ•°ã€‚
**ç­”æ¡ˆï¼š**
```javascript
function debounce(fn, delay = 300) {
  let timer = null;

  return function(...args) {
    clearTimeout(timer);
    timer = setTimeout(() => {
      fn.apply(this, args);
    }, delay);
  };
}

// ä½¿ç”¨
const search = debounce((value) => {
  console.log('æœç´¢:', value);
}, 500);

search('a'); // ä¸æ‰§è¡Œ
search('ab'); // ä¸æ‰§è¡Œ
search('abc'); // 500msåæ‰§è¡Œ
```

---

# ä»Šæ—¥æ€»ç»“

## ä»Šå¤©å­¦ä¹ çš„æ ¸å¿ƒå†…å®¹

### CSSå¸ƒå±€
1. **displayä¸‰å¤§å€¼**ï¼šinlineï¼ˆè¡Œå†…ï¼‰ã€blockï¼ˆå—çº§ï¼‰ã€inline-blockï¼ˆè¡Œå†…å—ï¼‰
2. **å…ƒç´ éšè—**ï¼šdisplay:noneã€visibility:hiddenã€opacity:0åŠå…¶åŒºåˆ«

### Vueè¿›é˜¶
1. **ç»„ä»¶é€šä¿¡**ï¼šprops/emitï¼ˆçˆ¶å­ï¼‰ã€provide/injectï¼ˆè·¨çº§ï¼‰ã€v-modelï¼ˆåŒå‘ç»‘å®šï¼‰
2. **ç”Ÿå‘½å‘¨æœŸ**ï¼šåˆ›å»ºã€æŒ‚è½½ã€æ›´æ–°ã€é”€æ¯å››å¤§é˜¶æ®µï¼ŒVue2ä¸Vue3å¯¹ç…§

### JavaScriptæ ¸å¿ƒ
1. **thisæŒ‡å‘**ï¼šäº”ç§ç»‘å®šè§„åˆ™åŠä¼˜å…ˆçº§
2. **ä½œç”¨åŸŸ**ï¼šå…¨å±€ã€å‡½æ•°ã€å—çº§ä¸‰ç§ä½œç”¨åŸŸ
3. **é—­åŒ…**ï¼šå®šä¹‰ã€ä½œç”¨ã€åº”ç”¨åœºæ™¯åŠå®Œæ•´å®ç°

### äº‹ä»¶æœºåˆ¶
1. **addEventListenerè¯¦è§£**ï¼šcaptureã€onceã€passiveã€signalå››å¤§å‚æ•°
2. **é˜²æŠ–èŠ‚æµ**ï¼šæ¦‚å¿µã€åº”ç”¨åœºæ™¯ã€å®Œæ•´å®ç°ä»£ç 

## å¿…é¡»è®°ä½çš„æ ¸å¿ƒå£è¯€

```
CSSï¼šinlineè¡Œå†…blockå—çº§ã€inline-blockæœ€çµæ´»
Vueï¼šçˆ¶ä¼ å­propsã€å­ä¼ çˆ¶emitã€è·¨çº§provide inject
JSï¼šæ–°æ˜¾éšé»˜ç®­ã€thisæŒ‡å‘äº”è§„åˆ™ã€é—­åŒ…ä¸‰è¦ç´ 
äº‹ä»¶ï¼šcapture once passive signalã€é˜²æŠ–èŠ‚æµè¦åŒºåˆ†
```

## æ˜å¤©å­¦ä¹ é¢„å‘Š

- HTTPåè®®ä¸ç½‘ç»œè¯·æ±‚
- æµè§ˆå™¨å·¥ä½œåŸç†
- æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆ
- å‰ç«¯å·¥ç¨‹åŒ–åŸºç¡€

**åŠ æ²¹ï¼ç»§ç»­åŠªåŠ›ï¼ğŸ’ª**
